(this.webpackJsonpuser=this.webpackJsonpuser||[]).push([[0],{129:function(t,e){t.exports={site202131Url:"http://localhost:8081"}},157:function(t,e,a){},158:function(t,e,a){},188:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a.n(n),i=a(43),c=a.n(i),r=(a(157),a(158),a(19)),o=a(20),l=a(39),u=a(24),d=a(23),h=a(244),j=a(226),p=a(245),b=a(125),v=a(246),f=a(90),O=a.n(f),g=a(1),m=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n.logout=n.logout.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"logout",value:function(){O.a.remove("jwt"),window.location.href="/user/index.html"}},{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){return!0===this.state.isAuthenticated?Object(g.jsxs)("div",{className:"text-center",children:[Object(g.jsx)(v.a.Link,{href:"#action1",children:"Pagina personale"}),Object(g.jsx)(v.a.Link,{href:"#action2",children:"Prenotazioni effettuate"}),Object(g.jsx)(v.a.Link,{onClick:this.logout,children:"Logout"})]}):Object(g.jsx)("div",{className:"text-center",children:Object(g.jsx)(v.a.Link,{href:"/public/login.html",children:"Login"})})}}]),a}(s.a.Component),x=a(242),y=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=this;return Object(g.jsxs)("div",{className:"row p-2",children:[Object(g.jsx)("div",{className:"col-6 d-flex flex-row align-items-center",children:Object(g.jsx)(p.a.Check,{type:"checkbox",label:"Disponibilit\xe0",className:"m-0",onChange:function(e){t.props.showOnlyAvailable(e.target.checked)}})}),Object(g.jsx)("div",{className:"col-6 d-flex flex-row-reverse align-items-center",children:Object(g.jsxs)(x.a,{children:[Object(g.jsx)(x.a.Toggle,{id:"dropdown-basic",children:"Ordina"}),Object(g.jsxs)(x.a.Menu,{children:[Object(g.jsx)(x.a.Item,{onClick:function(e){t.props.sort(!0)},children:"Prezzo crescente"}),Object(g.jsx)(x.a.Item,{onClick:function(e){t.props.sort(!1)},children:"Prezzo decrescente"})]})]})})]})}}]),a}(s.a.Component),k=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return Object(g.jsxs)("div",{children:[Object(g.jsx)(h.a,{bg:"light",expand:"false",children:Object(g.jsxs)(j.a,{fluid:!0,children:[Object(g.jsx)(h.a.Brand,{href:"/user/index.html",children:Object(g.jsx)("img",{src:"https://cdn.discordapp.com/attachments/918079016651604009/918082983964061726/CAtena_montuosa.png",alt:"logo",height:"35"})}),Object(g.jsx)(p.a,{className:"d-flex",onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(g.jsx)(b.a,{type:"search",placeholder:"Search",name:"searchInput",className:"me-2","aria-label":"Search"})}),Object(g.jsx)(h.a.Toggle,{"aria-controls":"navbarScroll"}),Object(g.jsx)(h.a.Collapse,{id:"navbarScroll",children:Object(g.jsx)(v.a,{className:"me-auto my-2 my-lg-0",navbarScroll:!0,children:Object(g.jsx)(m,{isAuthenticated:this.state.isAuthenticated})})})]})}),Object(g.jsx)(y,{showOnlyAvailable:this.props.showOnlyAvailable,sort:this.props.sort})]})}}]),a}(s.a.Component),A=a(4),P=a(243),D=a(240),S=a(227),w=a(253),N=a(241),C=a(127),I=a(128),R=a.n(I),T=a(129),z=a.n(T),F=R.a.create({baseURL:z.a.site202131Url,headers:{"Content-type":"application/json",dataType:"jsonp",withCredentials:!0}}),L=new(function(){function t(){Object(r.a)(this,t)}return Object(o.a)(t,[{key:"test",value:function(){return F.get("/test")}},{key:"login",value:function(t,e){var a={email:t,plainTextPassword:e};return F.post("/api/public/login",a)}},{key:"signUp",value:function(){}},{key:"getUser",value:function(t){var e=t?"?id="+t:"";return F.get("/api/user/"+e)}},{key:"postUser",value:function(t,e){return null!=t?F.post("/api/user?id="+t,e):F.post("/api/user",e)}},{key:"getProduct",value:function(t){return F.get("/api/product/?id="+t)}},{key:"getAllProduct",value:function(t,e){return F.get("/api/product/all?filter="+t+"&&sort="+e)}},{key:"postProduct",value:function(t,e){return F.post("/api/product/?id="+t,e)}},{key:"getReservation",value:function(t){return F.get("/api/reservation/?id="+t)}},{key:"getAllReservation",value:function(t,e){return F.get("/api/reservation/all",{filter:t,sort:e})}},{key:"postReservation",value:function(t){return F.post("/api/reservation",t)}}]),t}());function U(t){return{day:t.getDate().toString(),month:(t.getMonth()+1).toString(),year:t.getFullYear().toString()}}function M(t,e){return Math.round((e-t)/864e5)+1}function _(t,e){return!!t.find((function(t){return new Date(t).getTime()==e.getTime()}))}Date.prototype.addDays=function(t){var e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e};var W=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;Object(r.a)(this,a),n=e.call(this,t);var s=function(t){var e=0,a=[];for(e in t)for(var n=new Date(parseInt(t[e].startDate.year),parseInt(t[e].startDate.month)-1,parseInt(t[e].startDate.day)),s=new Date(parseInt(t[e].endDate.year),parseInt(t[e].endDate.month)-1,parseInt(t[e].endDate.day)),i=n;i<=s;)a.push(new Date(i)),i=i.addDays(1);return a}(t.bookings).map((function(t){return t.getTime()}));return n.state={value:[null,null],dates:s,bookings:t.bookings,price:t.finalPrice,product:t.product,isAuthenticated:t.isAuthenticated},n.disabledDays=n.disabledDays.bind(Object(l.a)(n)),n.checkDateRange=n.checkDateRange.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"disabledDays",value:function(t){return null==this.state.dates?null:this.state.dates.includes(t.getTime())}},{key:"checkDateRange",value:function(t){if(2==t.length&&null!=this.state.dates)for(var e=t[0],a=t[1];e<=a;){if(1==_(this.state.dates,e))return!1;e=e.addDays(1)}return!0}},{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return Object(g.jsxs)("div",{className:"pb-0 mt-2",children:[Object(g.jsx)(S.b,{dateAdapter:D.a,children:Object(g.jsx)(N.a,{disablePast:!0,shouldDisableDate:this.disabledDays,startText:"Data di inizio",endText:"Data di fine",value:this.state.value,onChange:function(e){t.setState({value:e})},renderInput:function(t,e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(P.a,Object(A.a)({},t)),Object(g.jsx)(w.a,{sx:{mx:1},children:" a "}),Object(g.jsx)(P.a,Object(A.a)({},e))]})},inputFormat:"dd/MM/yyyy",onAccept:function(e){t.checkDateRange(e)}})}),Object(g.jsxs)("div",{children:["Giorni di noleggio: ",this.state.value[0]&&this.state.value[1]?M(this.state.value[0],this.state.value[1]):0]}),Object(g.jsxs)("div",{children:["Prezzo totale: ",this.state.value[0]&&this.state.value[1]?(M(this.state.value[0],this.state.value[1])*this.state.price).toFixed(2):0," \u20ac"]}),this.state.isAuthenticated?Object(g.jsx)(C.a,{className:"mt-2 w-100",onClick:function(e){console.log("Prenotazione"),e.preventDefault(),t.state.value[0]&&t.state.value[1]||alert("Data prenotazione non valida"),L.getUser().then((function(e){var a={clientEmail:e.data.data.email,clientName:e.data.data.userName,clientSurname:e.data.data.userSurname,productId:t.state.product._id,prodcutTitle:t.state.product.title,productBrand:t.state.product.brand,productImage:t.state.product.image,bookingDate:U(new Date),startDate:U(t.state.value[0]),endDate:U(t.state.value[1]),isTaken:!1,isReturned:!1,price:(M(t.state.value[0],t.state.value[1])*t.state.price).toFixed(2),description:"",note:""};console.log(a),L.postReservation(a).then((function(a){var n={productId:t.state.product._id,clientId:e.data.data.email,reservationId:a.data.data._id,startDate:U(t.state.value[0]),endDate:U(t.state.value[1])},s=t.state.bookings;s.push(n),L.postProduct(t.state.product._id,{bookings:s}),alert("Prenotazione effettuata con successo")}))}))},href:"/user/index.html",children:"Prenota ora"}):Object(g.jsx)(C.a,{className:"mt-2 w-100",href:"/public/login.html",children:"Accedi per prenotare"})]})}}]),a}(s.a.Component),B=a(249),q=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=parseInt(this.props.quality);return Object(g.jsxs)("div",{className:"mb-1 d-flex align-items-center",children:["Qualit\xe0:",Object(g.jsx)(B.a,{name:"read-only",value:t,max:3,readOnly:!0})]})}}]),a}(s.a.Component),E=a(251),J=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=this.props.tags.map((function(t){return Object(g.jsx)(E.a,{className:"m-1",label:t},t)}));return Object(g.jsx)("div",{className:"d-flex justify-content-center",children:t})}}]),a}(s.a.Component),V=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={product:t.product,discountedPrice:t.product.discount.onSaleType?(t.product.price*(100-t.product.discount.onSaleValue)/100).toFixed(2):(t.product.price-t.product.discount.onSaleValue).toFixed(2),isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){return Object(g.jsx)("div",{className:"m-2 bg-light rounded-3 border border-dark",children:Object(g.jsxs)(h.a,{bg:"trasparent",expand:"false",children:[Object(g.jsx)(h.a.Toggle,{"aria-controls":"navbarScroll",className:"border-0 w-100",children:Object(g.jsxs)("div",{className:"row m-0",children:[Object(g.jsx)("div",{className:"col-5 p-0 d-flex align-items-center align-self-center",children:Object(g.jsx)("img",{className:"img-fluid img-responsive mx-auto d-block",src:this.state.product.image,alt:"Immagine"})}),Object(g.jsxs)("div",{className:"col-7 bg-trasparent align-self-center",style:{paddingRight:"0"},children:[Object(g.jsx)("div",{className:"text-truncate",children:this.state.product.title}),Object(g.jsx)("div",{children:this.state.product.brand}),this.state.product.discount.onSale?Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{style:{color:"red"},children:[this.state.discountedPrice," \u20ac ",Object(g.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]}),Object(g.jsxs)("div",{style:{textDecorationLine:"line-through",fontSize:"0.75em"},children:[this.state.product.price," \u20ac"]})]}):Object(g.jsxs)("div",{children:[this.state.product.price," \u20ac ",Object(g.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]})]})]})}),Object(g.jsx)(h.a.Collapse,{id:"navbarScroll",children:Object(g.jsxs)(v.a,{className:"me-auto p-2 pb-0",navbarScroll:!0,children:[Object(g.jsx)(J,{tags:this.state.product.tags}),Object(g.jsx)("div",{style:{"text-align":"justify"},children:this.state.product.description}),Object(g.jsx)(q,{quality:this.state.product.quality}),this.state.product.available?Object(g.jsx)(W,{bookings:this.state.product.bookings,finalPrice:this.state.product.discount.onSale?this.state.discountedPrice:this.state.product.price,isAuthenticated:this.state.isAuthenticated,product:this.state.product}):Object(g.jsx)(C.a,{disabled:!0,children:"Prodotto non disponibile"})]})})]})})}}]),a}(s.a.Component),G=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;if(0===this.props.products.length)return Object(g.jsx)("div",{});var e=this.props.products.map((function(e){return Object(g.jsx)(V,{product:e,isAuthenticated:t.state.isAuthenticated},e._id)}));return Object(g.jsx)("div",{children:e})}}]),a}(s.a.Component),Q=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={products:[],filteredProducts:[],isAuthenticated:!1},n.searchProducts=n.searchProducts.bind(Object(l.a)(n)),n.showOnlyAvailableProducts=n.showOnlyAvailableProducts.bind(Object(l.a)(n)),n.sortProducts=n.sortProducts.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"searchProducts",value:function(t){var e=this;console.log("searchProducts("+t+")"),L.getAllProduct(t,!0).then((function(t){e.setState({products:t.data.data,filteredProducts:t.data.data})}))}},{key:"showOnlyAvailableProducts",value:function(t){console.log("showOnlyAvailableProducts("+t+")");var e=[];if(1==t)for(var a in this.state.products)this.state.products[a].available==t&&e.push(this.state.products[a]);else e=this.state.products;this.setState({filteredProducts:e})}},{key:"sortProducts",value:function(t){console.log("sortProducts("+t+")");var e=this.state.products;e.sort((function(t,e){return t.price-e.price})),0==t&&e.reverse(),this.setState({products:e,filteredProducts:e})}},{key:"componentDidMount",value:function(){var t=this;L.getAllProduct("",!0).then((function(e){t.setState({products:e.data.data,filteredProducts:e.data.data})})),O.a.get("jwt")&&L.getUser().then((function(){t.setState({isAuthenticated:!0})})).catch((function(){t.setState({isAuthenticated:!1})}))}},{key:"render",value:function(){return Object(g.jsxs)("div",{children:[Object(g.jsx)(k,{search:this.searchProducts,showOnlyAvailable:this.showOnlyAvailableProducts,sort:this.sortProducts,isAuthenticated:this.state.isAuthenticated}),Object(g.jsx)(G,{products:this.state.filteredProducts,isAuthenticated:this.state.isAuthenticated})]})}}]),a}(s.a.Component);a(187);var Y=function(){return Object(g.jsx)("div",{className:"App",children:Object(g.jsx)(Q,{})})},H=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,256)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),n(t),s(t),i(t),c(t)}))};c.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(Y,{})}),document.getElementById("root")),H()}},[[188,1,2]]]);
//# sourceMappingURL=main.971b7d23.chunk.js.map