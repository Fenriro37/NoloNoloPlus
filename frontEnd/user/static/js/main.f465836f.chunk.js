(this.webpackJsonpuser=this.webpackJsonpuser||[]).push([[0],{154:function(e,t){e.exports={site202131Url:"http://site202131.tw.cs.unibo.it"}},192:function(e,t,a){},193:function(e,t,a){},223:function(e,t,a){"use strict";a.r(t);var s=a(1),i=a.n(s),r=a(40),n=a.n(r),o=(a(192),a(193),a(143),a(18)),c=a(20),l=a(19),d=a(24),h=a(23),u=a(79),b=a.n(u),j=a(153),v=a.n(j),p=a(154),x=a.n(p),m=v.a.create({baseURL:x.a.site202131Url,headers:{"Content-type":"application/json",dataType:"jsonp",withCredentials:!0}}),O=new(function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"login",value:function(e,t){var a={email:e,plainTextPassword:t};return m.post("/api/public/login",a)}},{key:"getUser",value:function(e){var t=e?"?id="+e:"";return m.get("/api/user/"+t)}},{key:"postUser",value:function(e,t){return null!=e?m.post("/api/user?id="+e,t):m.post("/api/user",t)}},{key:"getProduct",value:function(e){return m.get("/api/product/?id="+e)}},{key:"getAllProduct",value:function(e,t){return m.get("/api/product/all?filter="+e+"&sort="+t)}},{key:"postProduct",value:function(e,t){return m.post("/api/product/?id="+e,t)}},{key:"getReservation",value:function(e){return m.get("/api/reservation/?id="+e)}},{key:"getAllReservation",value:function(e,t){return m.get("/api/reservation/all?filter="+e+"&sort="+t)}},{key:"postReservation",value:function(e,t){return null==e?m.post("/api/reservation",t):m.post("/api/reservation?id="+e,t)}},{key:"deleteReservation",value:function(e){return m.delete("/api/reservation?id="+e)}}]),e}()),y=a(284),f=a(162),g=a(3),D=a(276),w=a(290),S=a(260),N=a(277),k=a(278),P=a(283),C=a(270);function F(e){return{day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}}function I(e,t){return Math.round((t-e)/864e5)+1}function A(e,t){return!!e.find((function(e){return new Date(e).getTime()==t.getTime()}))}function T(e){var t=0,a=[];for(t in e)for(var s=new Date(parseInt(e[t].startDate.year),parseInt(e[t].startDate.month)-1,parseInt(e[t].startDate.day)),i=new Date(parseInt(e[t].endDate.year),parseInt(e[t].endDate.month)-1,parseInt(e[t].endDate.day)),r=s;r<=i;)a.push(new Date(r)),r=r.addDays(1);return a}Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};var z=a(0),R=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;Object(o.a)(this,a),s=t.call(this,e);var i=T(e.bookings).map((function(e){return e.getTime()}));return s.state={value:[null,null],dates:i,bookings:e.bookings,fixedPrice:e.finalFixedPrice,variablePrice:e.originalVariablePrice,variableDiscount:e.variableDiscount,product:e.product,isAuthenticated:e.isAuthenticated,show:!1,loading:!0,done:!1},s.priceCalculator=s.priceCalculator.bind(Object(l.a)(s)),s.handleClose=s.handleClose.bind(Object(l.a)(s)),s.handleShow=s.handleShow.bind(Object(l.a)(s)),s.disabledDays=s.disabledDays.bind(Object(l.a)(s)),s.checkDateRange=s.checkDateRange.bind(Object(l.a)(s)),s.makeReservation=s.makeReservation.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"priceCalculator",value:function(){var e;return this.state.value[0]&&this.state.value[1]?1==this.state.variableDiscount.onSale&&I(this.state.value[0],this.state.value[1])>this.state.variableDiscount.days?(e=1==this.state.variableDiscount.onSaleType?I(this.state.value[0],this.state.value[1])*this.state.variablePrice*(100-this.state.variableDiscount.onSaleValue)/100:I(this.state.value[0],this.state.value[1])*this.state.variablePrice-this.state.variableDiscount.onSaleValue,parseFloat(this.state.fixedPrice+e)):parseFloat(this.state.fixedPrice+I(this.state.value[0],this.state.value[1])*this.state.variablePrice):0}},{key:"handleClose",value:function(){this.setState({show:!1}),window.location.replace("/user/reservation")}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"disabledDays",value:function(e){return null==this.state.dates?null:this.state.dates.includes(e.getTime())}},{key:"checkDateRange",value:function(e){if(2==e.length&&null!=this.state.dates&&e[0]&&e[1]){if(e[0]>e[1]||"Invalid Date"==e[0].toString()||"Invalid Date"==e[1].toString())return!1;for(var t=e[0],a=e[1];t<=a;){if(1==A(this.state.dates,t))return!1;t=t.addDays(1)}return!0}return!1}},{key:"makeReservation",value:function(){var e=this;this.setState({loading:!0}),this.handleShow(),O.getUser().then((function(t){var a={clientEmail:t.data.data.email,clientName:t.data.data.userName,clientSurname:t.data.data.userSurname,productId:e.state.product._id,productTitle:e.state.product.title,productBrand:e.state.product.brand,productImage:e.state.product.image,bookingDate:F(new Date),startDate:F(e.state.value[0]),endDate:F(e.state.value[1]),isTaken:!1,isReturned:!1,totalPrice:e.priceCalculator(),fixedPrice:e.state.product.fixedPrice,variablePrice:e.state.product.price,fixedDiscount:e.state.product.discount,variableDiscount:e.state.product.overDays,description:"",note:""};O.postReservation(null,a).then((function(a){var s={productId:e.state.product._id,clientId:t.data.data.email,reservationId:a.data.data._id,startDate:F(e.state.value[0]),endDate:F(e.state.value[1]),total:e.priceCalculator()},i=e.state.bookings;i.push(s),O.postProduct(e.state.product._id,{bookings:i}).then((function(){e.setState({loading:!1,done:!0})})).catch((function(){e.setState({loading:!1,done:!1})}))}))}))}},{key:"componentWillReceiveProps",value:function(e){this.setState({isAuthenticated:e.isAuthenticated})}},{key:"render",value:function(){var e=this;return Object(z.jsxs)("div",{className:"pb-0 mt-2",children:[Object(z.jsx)(w.a,{className:"d-flex justify-content-center mb-2",children:Object(z.jsx)(S.b,{dateAdapter:D.a,children:Object(z.jsx)(N.a,{disabled:!this.state.isAuthenticated,disablePast:!0,shouldDisableDate:this.disabledDays,startText:"Data di inizio",endText:"Data di fine",value:this.state.value,onChange:function(t){e.setState({value:t})},renderInput:function(e,t){return Object(z.jsxs)(i.a.Fragment,{children:[Object(z.jsx)(k.a,Object(g.a)({},e)),Object(z.jsx)(w.a,{sx:{mx:1},children:"a"}),Object(z.jsx)(k.a,Object(g.a)({},t))]})},inputFormat:"dd/MM/yyyy"})})}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:"Giorni di noleggio:"}),Object(z.jsx)("div",{className:"col-4 text-end",children:this.checkDateRange(this.state.value)?I(this.state.value[0],this.state.value[1]):0})]}),Object(z.jsxs)("div",{className:"row mb-2",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:"Prezzo totale:"}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[this.checkDateRange(this.state.value)?this.priceCalculator().toFixed(2):"0.00"," \u20ac"]})]}),this.state.isAuthenticated?Object(z.jsx)(f.a,{disabled:!this.checkDateRange(this.state.value),className:"mt-11 w-100",onClick:function(t){t.preventDefault(),e.makeReservation()},children:this.checkDateRange(this.state.value)?Object(z.jsx)("span",{children:"Prenota ora"}):Object(z.jsx)("span",{children:"Seleziona una data valida"})}):Object(z.jsx)(f.a,{className:"mt-1 w-100",href:"/public/login.html",children:"Accedi per prenotare"}),Object(z.jsxs)(P.a,{show:this.state.show,onHide:this.handleClose,backdrop:"static",keyboard:!1,centered:!0,children:[Object(z.jsx)(P.a.Body,{children:this.state.loading?Object(z.jsxs)("div",{className:"d-flex align-items-center",children:["Effetuo la prenotazione\xa0",Object(z.jsx)(C.a,{variant:"primary",animation:"border",role:"status",children:Object(z.jsx)("span",{className:"visually-hidden",children:"Caricamento..."})})]}):this.state.done?Object(z.jsx)(z.Fragment,{children:"Prenotazione effettuata."}):Object(z.jsx)(z.Fragment,{children:"Errore durante la prenotazione."})}),Object(z.jsx)(P.a.Footer,{children:Object(z.jsx)(f.a,{variant:"secondary",onClick:this.handleClose,disabled:this.state.loading,children:"Chiudi"})})]})]})}}]),a}(i.a.Component),M=a(287),V=a(282),E=a(271),L=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){var e=parseInt(this.props.quality),t="";switch(e){case 1:t="condizioni accettabili";break;case 2:t="condizioni buone";break;case 3:t="condizioni ottime";break;default:t=""}return Object(z.jsx)("div",{className:"d-flex align-items-center",tabIndex:"0",children:Object(z.jsx)(V.a,{placement:"right",overlay:Object(z.jsx)(E.a,{children:t}),children:Object(z.jsxs)("span",{class:"d-flex align-items-center",children:[Object(z.jsx)("b",{children:"Qualit\xe0:"}),Object(z.jsx)(M.a,{name:"read-only",value:e,max:3,readOnly:!0})]})})})}}]),a}(i.a.Component),B=a(272),G=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props.tags.map((function(e){return Object(z.jsx)(B.a,{pill:!0,bg:"primary",className:"m-1",children:e},e)}));return Object(z.jsxs)("div",{tabIndex:"0",children:[Object(z.jsx)("b",{children:"Categoria:"}),Object(z.jsx)("div",{className:"d-flex justify-content-center flex-wrap",children:e})]})}}]),a}(i.a.Component),Y=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={originalFixedPrice:s.props.originalFixedPrice,discountedFixedPrice:s.props.discountedFixdedPrice,originalVariablePrice:s.props.originalVariablePrice,variableDiscount:s.props.variableDiscount},s}return Object(c.a)(a,[{key:"render",value:function(){return this.state.originalFixedPrice!=this.state.discountedFixedPrice?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)("div",{children:[Object(z.jsxs)("span",{style:{textDecorationLine:"line-through"},tabIndex:"0",children:[Object(z.jsx)("b",{children:"Prezzo fisso: "})," ",this.state.originalFixedPrice," \u20ac"]}),Object(z.jsx)("br",{}),Object(z.jsxs)("span",{style:{color:"red"},tabIndex:"0",children:[Object(z.jsx)("b",{children:"Prezzo fisso scontato: "})," ",this.state.discountedFixedPrice," \u20ac"]})]}),Object(z.jsxs)("div",{children:[Object(z.jsxs)("span",{tabIndex:"0",children:[Object(z.jsx)("b",{children:"Prezzo giornaliero: "})," ",this.state.originalVariablePrice," \u20ac"]}),Object(z.jsx)("br",{}),this.state.variableDiscount.onSale?Object(z.jsxs)("span",{style:{color:"red"},tabIndex:"0",children:["Sconto ",this.state.variableDiscount.onSaleType?"del ":"di ",parseFloat(this.state.variableDiscount.onSaleValue).toFixed(2),this.state.variableDiscount.onSaleType?"% ":" \u20ac ","sul costo giornaliero se superi ",this.state.variableDiscount.days," ",parseInt(this.state.variableDiscount.days)>1?"giorni ":"giorno ","di noleggio."]}):Object(z.jsx)(z.Fragment,{})]})]}):Object(z.jsxs)("div",{children:[Object(z.jsxs)("span",{tabIndex:"0",children:[Object(z.jsx)("b",{children:"Prezzo fisso: "})," ",parseFloat(this.state.originalFixedPrice).toFixed(2)," \u20ac"]}),Object(z.jsx)("br",{}),Object(z.jsxs)("span",{tabIndex:"0",children:[Object(z.jsx)("b",{children:"Prezzo giornaliero: "})," ",parseFloat(this.state.originalVariablePrice).toFixed(2)," \u20ac"]}),Object(z.jsx)("br",{}),this.state.variableDiscount.onSale?Object(z.jsxs)("span",{style:{color:"red"},tabIndex:"0",children:["Sconto ",this.state.variableDiscount.onSaleType?"del ":"di ",parseFloat(this.state.variableDiscount.onSaleValue).toFixed(2),this.state.variableDiscount.onSaleType?"% ":" \u20ac ","sul prezzo giornaliero se superi ",this.state.variableDiscount.days," ",parseFloat(this.state.variableDiscount.days)>1?"giorni ":"giorno ","di noleggio."]}):Object(z.jsx)(z.Fragment,{})]})}}]),a}(i.a.Component),_=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={product:e.product,isAuthenticated:e.isAuthenticated,discountedFixedPrice:e.product.discount.onSale?e.product.discount.onSaleType?e.product.fixedPrice*parseFloat(100-e.product.discount.onSaleValue)/100:e.product.fixedPrice-e.product.discount.onSaleValue:e.product.fixedPrice},s}return Object(c.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({isAuthenticated:e.isAuthenticated})}},{key:"render",value:function(){return Object(z.jsx)(y.a,{className:"m-2 bg-light rounded-3 border border-dark",children:Object(z.jsxs)(y.a.Item,{eventKey:"0",children:[Object(z.jsx)(y.a.Header,{children:Object(z.jsxs)("div",{className:"row",style:{width:"95%",height:"7.5em"},children:[Object(z.jsx)("div",{className:"col-6 h-100 d-flex align-items-center",children:Object(z.jsx)("img",{alt:"Immagine del prodotto "+this.state.product.title,className:"img-fluid img-responsive mx-auto d-block",style:{maxHeight:"100%",maxWidth:"100%"},src:this.state.product.image})}),Object(z.jsx)("div",{className:"col-6 d-flex align-items-center",children:Object(z.jsxs)("div",{children:[Object(z.jsx)("b",{children:this.state.product.title}),Object(z.jsx)("br",{}),this.state.product.brand]})})]})}),Object(z.jsxs)(y.a.Body,{children:[Object(z.jsx)(G,{tags:this.state.product.tags}),Object(z.jsxs)("div",{style:{textAlign:"justify"},tabIndex:"0",children:[Object(z.jsx)("b",{children:"Descrizione:"}),Object(z.jsx)("br",{}),this.state.product.description]}),Object(z.jsx)(L,{quality:this.state.product.quality}),Object(z.jsx)(Y,{originalFixedPrice:parseFloat(this.state.product.fixedPrice).toFixed(2),discountedFixdedPrice:parseFloat(this.state.discountedFixedPrice).toFixed(2),originalVariablePrice:parseFloat(this.state.product.price).toFixed(2),variableDiscount:this.state.product.overDays}),Object(z.jsx)("hr",{}),Object(z.jsx)("div",{className:"mb-2",tabIndex:"0",children:Object(z.jsxs)("b",{children:["Prenotazione",this.state.product.available?":":" (non disponibile):"]})}),this.state.product.available?Object(z.jsx)(R,{bookings:this.state.product.bookings,finalFixedPrice:this.state.product.discount.onSale?this.state.discountedFixedPrice:this.state.product.fixedPrice,originalVariablePrice:this.state.product.price,variableDiscount:this.state.product.overDays,isAuthenticated:this.state.isAuthenticated,product:this.state.product}):Object(z.jsx)(f.a,{disabled:!0,className:"w-100",children:"Prodotto non disponibile"})]})]})})}}]),a}(i.a.Component),H=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={value:[null,null],dates:[],bookings:[],reservation:e.reservation,variableDiscount:e.reservation.variableDiscount,showEditModal:!1,showLoadingModal:!1,loading:!1,error:!1,isEditing:!0},s.priceCalculator=s.priceCalculator.bind(Object(l.a)(s)),s.handleClose=s.handleClose.bind(Object(l.a)(s)),s.handleShow=s.handleShow.bind(Object(l.a)(s)),s.disabledDays=s.disabledDays.bind(Object(l.a)(s)),s.checkDateRange=s.checkDateRange.bind(Object(l.a)(s)),s.updateReservation=s.updateReservation.bind(Object(l.a)(s)),s.deleteReservation=s.deleteReservation.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"priceCalculator",value:function(){var e;if(e=1==this.state.reservation.fixedDiscount.onSale?1==this.state.reservation.fixedDiscount.onSaleType?parseFloat(this.state.reservation.fixedPrice)*(100-parseFloat(this.state.reservation.fixedDiscount.onSaleValue))/100:parseFloat(this.state.reservation.fixedPrice)-parseFloat(this.state.reservation.fixedDiscount.onSaleValue):parseFloat(this.state.reservation.fixedPrice),this.state.value[0]&&this.state.value[1]){var t=I(this.state.value[0],this.state.value[1]);return 1==this.state.variableDiscount.onSale&&t>parseInt(this.state.variableDiscount.days)?e+(1==this.state.variableDiscount.onSaleType?t*parseFloat(this.state.reservation.variablePrice)*(100-parseFloat(this.state.variableDiscount.onSaleValue))/100:t*parseFloat(this.state.reservation.variablePrice)-parseFloat(this.state.variableDiscount.onSaleValue)):e+t*parseFloat(this.state.reservation.variablePrice)}return 0}},{key:"handleClose",value:function(){this.setState({showEditModal:!1})}},{key:"handleShow",value:function(){this.setState({showEditModal:!0})}},{key:"disabledDays",value:function(e){return null==this.state.dates?null:this.state.dates.includes(e.getTime())}},{key:"checkDateRange",value:function(e){if(2==e.length&&null!=this.state.dates&&e[0]&&e[1]){for(var t=e[0],a=e[1];t<=a;){if(1==A(this.state.dates,t))return!1;t=t.addDays(1)}return!0}return!1}},{key:"updateReservation",value:function(){var e=this;this.setState({loading:!0,showLoadingModal:!0}),this.handleClose(),O.postReservation(this.state.reservation._id,{bookingDate:F(new Date),startDate:F(this.state.value[0]),endDate:F(this.state.value[1]),totalPrice:this.priceCalculator()}).then((function(){var t=e.state.bookings;t=t.filter((function(t){return t.reservationId==e.state.reservation._id&&(t.startDate=F(e.state.value[0]),t.endDate=F(e.state.value[1]),t.total=e.priceCalculator()),!0})),O.postProduct(e.state.reservation.productId,{bookings:t}).then((function(){e.setState({loading:!1})})).catch((function(){e.setState({error:!0,loading:!1})}))}))}},{key:"deleteReservation",value:function(){var e=this;this.setState({isEditing:!1,loading:!0,showLoadingModal:!0}),this.handleClose(),O.deleteReservation(String(this.state.reservation._id)).then((function(){var t=e.state.bookings;t=t.filter((function(t){return t.reservationId!=e.state.reservation._id})),O.postProduct(e.state.reservation.productId,{bookings:t}).then((function(){e.setState({loading:!1})})).catch((function(){e.setState({error:!0,loading:!1})}))}))}},{key:"componentWillReceiveProps",value:function(e){var t=T(e.bookings).map((function(e){return e.getTime()})),a=T([this.state.reservation]).map((function(e){return e.getTime()})),s=t.filter((function(e){for(var t in a)if(e==a[t])return!1;return!0}));this.setState({dates:s,bookings:e.bookings})}},{key:"render",value:function(){var e,t=this;return e=1==this.state.reservation.fixedDiscount.onSale?1==this.state.reservation.fixedDiscount.onSaleType?parseFloat(this.state.reservation.fixedPrice)*(100-parseFloat(this.state.reservation.fixedDiscount.onSaleValue))/100:parseFloat(this.state.reservation.fixedPrice)-parseFloat(this.state.reservation.fixedDiscount.onSaleValue):parseFloat(this.state.reservation.fixedPrice),Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(f.a,{className:"w-100",variant:"primary",onClick:this.handleShow,children:"Modifica prenotazione"}),Object(z.jsxs)(P.a,{show:this.state.showEditModal,onHide:this.handleClose,keyboard:!1,centered:!0,children:[Object(z.jsx)(P.a.Header,{closeButton:!0,children:Object(z.jsx)(P.a.Title,{children:"Modifica prenotazione"})}),Object(z.jsxs)(P.a.Body,{className:"pb-0 mt-2",children:[Object(z.jsx)(w.a,{className:"d-flex justify-content-center mb-2",children:Object(z.jsx)(S.b,{dateAdapter:D.a,children:Object(z.jsx)(N.a,{disablePast:!0,shouldDisableDate:this.disabledDays,startText:"Data di inizio",endText:"Data di fine",value:this.state.value,onChange:function(e){t.setState({value:e})},renderInput:function(e,t){return Object(z.jsxs)(i.a.Fragment,{children:[Object(z.jsx)(k.a,Object(g.a)({},e)),Object(z.jsx)(w.a,{sx:{mx:1},children:"a"}),Object(z.jsx)(k.a,Object(g.a)({},t))]})},inputFormat:"dd/MM/yyyy"})})}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:"Prezzo fisso:"}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[e.toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:"Prezzo giornaliero:"}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[parseFloat(this.state.reservation.variablePrice).toFixed(2)," \u20ac"]})]}),this.state.variableDiscount.onSale?Object(z.jsx)("div",{className:"row",tabIndex:"0",children:Object(z.jsxs)("div",{className:"col-12",style:{textAlign:"justify"},children:["Sconto ",this.state.variableDiscount.onSaleType?"del ":"di ",parseFloat(this.state.variableDiscount.onSaleValue).toFixed(2),this.state.variableDiscount.onSaleType?"% ":" \u20ac ","sul costo giornaliero se superi ",this.state.variableDiscount.days," ",parseInt(this.state.variableDiscount.days)>1?"giorni ":"giorno ","di noleggio."]})}):Object(z.jsx)(z.Fragment,{}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:"Giorni di noleggio:"}),Object(z.jsx)("div",{className:"col-4 text-end",children:this.state.value[0]&&this.state.value[1]?I(this.state.value[0],this.state.value[1]):0})]}),Object(z.jsxs)("div",{className:"row mb-2",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:"Prezzo totale:"}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[this.priceCalculator().toFixed(2)," \u20ac"]})]})]}),Object(z.jsxs)(P.a.Footer,{className:"d-flex justify-content-between",children:[Object(z.jsx)(f.a,{disabled:!this.checkDateRange(this.state.value),className:"mt-3 w-100",variant:"success",onClick:function(e){e.preventDefault(),t.updateReservation()},children:this.checkDateRange(this.state.value)?Object(z.jsx)("span",{children:"Modifica ora"}):Object(z.jsx)("span",{children:"Seleziona una data valida"})}),Object(z.jsx)(f.a,{className:"w-100",variant:"danger",onClick:this.deleteReservation,children:"Cancella prenotazione"})]})]}),Object(z.jsxs)(P.a,{show:this.state.showLoadingModal,onHide:this.handleClose,backdrop:"static",keyboard:!1,centered:!0,children:[Object(z.jsx)(P.a.Body,{children:this.state.loading?Object(z.jsxs)("div",{className:"d-flex align-items-center",children:["Effetuo la ",this.state.isEditing?"prenotazione.":"cancellazione.","\xa0",Object(z.jsx)(C.a,{variant:"primary",animation:"border",role:"status",children:Object(z.jsx)("span",{className:"visually-hidden",children:"Caricamento..."})})]}):this.state.error?Object(z.jsxs)(z.Fragment,{children:["Errore durante la ",this.state.isEditing?"prenotazione.":"cancellazione."]}):Object(z.jsx)(z.Fragment,{children:this.state.isEditing?"Prenotazione modificata.":"Cancellazione effettuata."})}),Object(z.jsx)(P.a.Footer,{children:Object(z.jsx)(f.a,{variant:"secondary",onClick:function(){t.setState({showLoadingModal:!1}),window.location.reload(!1)},disabled:this.state.loading,children:"Chiudi"})})]})]})}}]),a}(i.a.Component),U=a(273),W=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={reservation:e.reservation,show:!1},s.handleClose=s.handleClose.bind(Object(l.a)(s)),s.handleShow=s.handleShow.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=I(new Date(this.state.reservation.startDate.year,this.state.reservation.startDate.month-1,this.state.reservation.startDate.day),new Date(this.state.reservation.endDate.year,this.state.reservation.endDate.month-1,this.state.reservation.endDate.day)),t=parseFloat(this.state.reservation.fixedPrice)/122*100,a=parseFloat(this.state.reservation.variablePrice)/122*100,s=this.state.reservation.fixedDiscount.onSale?this.state.reservation.fixedDiscount.onSaleType?t*(100-parseFloat(this.state.reservation.fixedDiscount.onSaleValue))/100:t-parseFloat(this.state.reservation.fixedDiscount.onSaleValue)/122*100:t,i=this.state.reservation.variableDiscount.onSale&&e>parseFloat(this.state.reservation.variableDiscount.days)?this.state.reservation.variableDiscount.onSaleType?e*a*(100-parseFloat(this.state.reservation.variableDiscount.onSaleValue))/100:(e*parseFloat(this.state.reservation.variablePrice)-parseFloat(this.state.reservation.variableDiscount.onSaleValue))/122*100:a*e,r=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())>new Date(this.state.reservation.endDate.year,this.state.reservation.endDate.month-1,this.state.reservation.endDate.day)&&0==this.state.reservation.isReturned&&1==this.state.reservation.isTaken?this.state.reservation.totalPrice/100*10:0;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(f.a,{className:"w-100",onClick:this.handleShow,children:"Richiedi fattura"}),Object(z.jsxs)(P.a,{fullscreen:"lg-down",size:"xl",show:this.state.show,onHide:this.handleClose,children:[Object(z.jsx)(P.a.Header,{children:Object(z.jsx)(P.a.Title,{children:"Fattura"})}),Object(z.jsxs)(P.a.Body,{children:[Object(z.jsx)("div",{className:"mb-3 element-to-hide-over-768",children:"Se sei da un dispositivo mobile, gira il device per una migliore lettura."}),Object(z.jsx)(U.a,{bordered:!0,responsive:!0,children:Object(z.jsxs)("tbody",{children:[Object(z.jsxs)("tr",{children:[Object(z.jsxs)("td",{colSpan:3,children:[this.state.reservation.clientName," ",this.state.reservation.clientSurname," - ",this.state.reservation.clientEmail]}),Object(z.jsx)("td",{colSpan:3,children:"NoloNoloPlus"})]}),Object(z.jsxs)("tr",{children:[Object(z.jsxs)("td",{colSpan:3,children:["Fattura: ",this.state.reservation._id]}),Object(z.jsxs)("td",{colSpan:3,children:["Data: ",this.state.reservation.endDate.day,"/",this.state.reservation.endDate.month,"/",this.state.reservation.endDate.year]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{className:"text-center",children:"Descrizione"}),Object(z.jsx)("th",{className:"text-center",children:"QNT"}),Object(z.jsx)("th",{className:"text-center",children:"Prezzo"}),Object(z.jsx)("th",{className:"text-center",children:"Sconto"}),Object(z.jsx)("th",{className:"text-center",children:"IVA"}),Object(z.jsx)("th",{className:"text-center",children:"Imponibile"})]}),Object(z.jsxs)("tr",{children:[Object(z.jsxs)("td",{children:[this.state.reservation.productTitle," ",this.state.reservation.productBrand," (fisso)"]}),Object(z.jsx)("td",{className:"text-end",children:"1"}),Object(z.jsxs)("td",{className:"text-end",children:[t.toFixed(2)," \u20ac"]}),Object(z.jsx)("td",{className:"text-end",children:this.state.reservation.fixedDiscount.onSale?this.state.reservation.fixedDiscount.onSaleType?parseFloat(this.state.reservation.fixedDiscount.onSaleValue).toFixed(2)+"%":(100-s/t*100).toFixed(2)+"%":"0%"}),Object(z.jsx)("td",{className:"text-end",children:"22%"}),Object(z.jsxs)("td",{className:"text-end",children:[s.toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsxs)("td",{children:[this.state.reservation.productTitle," ",this.state.reservation.productBrand," (variabile)"]}),Object(z.jsx)("td",{className:"text-end",children:e}),Object(z.jsxs)("td",{className:"text-end",children:[a.toFixed(2)," \u20ac"]}),Object(z.jsx)("td",{className:"text-end",children:this.state.reservation.variableDiscount.onSale&&e>this.state.reservation.variableDiscount.days?this.state.reservation.variableDiscount.onSaleType?parseFloat(this.state.reservation.variableDiscount.onSaleValue).toFixed(2)+"%":(100-i/e/a*100).toFixed(2)+"%":"0%"}),Object(z.jsx)("td",{className:"text-end",children:"22%"}),Object(z.jsxs)("td",{className:"text-end",children:[i.toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{colSpan:5,children:"Totale imponibile"}),Object(z.jsxs)("td",{className:"text-end",children:[(s+i).toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{colSpan:5,children:"IVA"}),Object(z.jsxs)("td",{className:"text-end",children:[(.22*(s+i+r)).toFixed(2)," \u20ac"]})]}),new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())>new Date(this.state.reservation.endDate.year,this.state.reservation.endDate.month-1,this.state.reservation.endDate.day)&&0==this.state.reservation.isReturned&&1==this.state.reservation.isTaken?Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{colSpan:5,children:"Penale"}),Object(z.jsxs)("td",{className:"text-end",children:[r.toFixed(2)," \u20ac"]})]}):Object(z.jsx)(z.Fragment,{}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{colSpan:5,children:Object(z.jsx)("b",{children:"Totale Fattura"})}),Object(z.jsxs)("td",{className:"text-end",children:[(1.22*(s+i)+r).toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{children:"Dettagli:"}),Object(z.jsx)("td",{colSpan:5,children:this.state.reservation.description})]})]})})]}),Object(z.jsx)(P.a.Footer,{className:"d-flex justify-content-start",children:Object(z.jsx)(f.a,{variant:"secondary",onClick:this.handleClose,children:"Chiudi"})})]})]})}}]),a}(i.a.Component),q=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={reservation:e.reservation,bookings:[],show:!1,status:""},s.handleClose=s.handleClose.bind(Object(l.a)(s)),s.handleShow=s.handleShow.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"componentDidMount",value:function(){var e=this,t="",a=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),s=new Date(this.state.reservation.startDate.year,this.state.reservation.startDate.month-1,this.state.reservation.startDate.day),i=new Date(this.state.reservation.endDate.year,this.state.reservation.endDate.month-1,this.state.reservation.endDate.day);t=a<s?"Prenotato":a>=s&&a<=i?"Attivo":"Concluso",this.setState({status:t}),O.getProduct(this.state.reservation.productId).then((function(t){e.setState({bookings:t.data.data.obj.bookings})}))}},{key:"render",value:function(){var e,t;e=1==this.state.reservation.fixedDiscount.onSale?1==this.state.reservation.fixedDiscount.onSaleType?parseFloat(this.state.reservation.fixedPrice)*(100-parseFloat(this.state.reservation.fixedDiscount.onSaleValue))/100:parseFloat(this.state.reservation.fixedPrice)-parseFloat(this.state.reservation.fixedDiscount.onSaleValue):parseFloat(this.state.reservation.fixedPrice);var a=I(new Date(this.state.reservation.startDate.year,this.state.reservation.startDate.month-1,this.state.reservation.startDate.day),new Date(this.state.reservation.endDate.year,this.state.reservation.endDate.month-1,this.state.reservation.endDate.day));return 1==this.state.reservation.variableDiscount.onSale&&a>parseInt(this.state.reservation.variableDiscount.days)?t=1==this.state.reservation.variableDiscount.onSaleType?a*parseFloat(this.state.reservation.variablePrice)*(100-parseFloat(this.state.reservation.variableDiscount.onSaleValue))/100:a*parseFloat(this.state.reservation.variablePrice)-parseFloat(this.state.reservation.variableDiscount.onSaleValue):(console.log(a),console.log(this.state.reservation.variablePrice),t=a*parseFloat(this.state.reservation.variablePrice)),Object(z.jsx)(y.a,{className:"m-2 bg-light rounded-3 border border-dark",children:Object(z.jsxs)(y.a.Item,{eventKey:"0",children:[Object(z.jsx)(y.a.Header,{children:Object(z.jsxs)("div",{className:"row",style:{width:"95%",height:"7.5em"},children:[Object(z.jsx)("div",{className:"col-6 h-100 d-flex align-items-center",children:Object(z.jsx)("img",{className:"img-fluid img-responsive mx-auto d-block",style:{maxHeight:"100%",maxWidth:"100%"},src:this.state.reservation.productImage,alt:"Immagine del prodotto "+this.state.reservation.productTitle})}),Object(z.jsx)("div",{className:"col-6 d-flex align-items-center",children:Object(z.jsxs)("div",{children:[Object(z.jsx)("b",{children:this.state.reservation.productTitle}),Object(z.jsx)("br",{}),this.state.reservation.productBrand,Object(z.jsx)("br",{}),Object(z.jsxs)("b",{children:[this.state.reservation.bookingDate.day,"/",this.state.reservation.bookingDate.month,"/",this.state.reservation.bookingDate.year]})]})})]})}),Object(z.jsxs)(y.a.Body,{children:[Object(z.jsxs)("div",{tabIndex:"0",children:["Identificativo della prenotazione:",Object(z.jsx)("br",{}),Object(z.jsx)("b",{children:this.state.reservation._id})]}),Object(z.jsx)("hr",{}),Object(z.jsxs)("div",{children:[Object(z.jsxs)("div",{className:"row d-flex justify-content-between",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Data prenotazione:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[this.state.reservation.bookingDate.day,"/",this.state.reservation.bookingDate.month,"/",this.state.reservation.bookingDate.year]})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Status:"})}),Object(z.jsx)("div",{className:"col-4 text-end",children:Object(z.jsx)("b",{children:this.state.status})})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Data di inizio noleggio:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[this.state.reservation.startDate.day,"/",this.state.reservation.startDate.month,"/",this.state.reservation.startDate.year]})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Data di fine noleggio:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[this.state.reservation.endDate.day,"/",this.state.reservation.endDate.month,"/",this.state.reservation.endDate.year]})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Prezzo fisso:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[parseFloat(e).toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Prezzo variabile:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[parseFloat(t).toFixed(2)," \u20ac"]})]}),Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Prezzo totale:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[parseFloat(this.state.reservation.totalPrice).toFixed(2)," \u20ac"]})]}),new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())>new Date(this.state.reservation.endDate.year,this.state.reservation.endDate.month-1,this.state.reservation.endDate.day)&&0==this.state.reservation.isReturned&&1==this.state.reservation.isTaken?Object(z.jsxs)("div",{className:"row",tabIndex:"0",children:[Object(z.jsx)("div",{className:"col-8",children:Object(z.jsx)("b",{children:"Penale:"})}),Object(z.jsxs)("div",{className:"col-4 text-end",children:[parseFloat(.1*this.state.reservation.totalPrice).toFixed(2)," \u20ac"]})]}):Object(z.jsx)(z.Fragment,{}),Object(z.jsx)("div",{className:"row",tabIndex:"0",children:Object(z.jsx)("div",{className:"col-12",children:Object(z.jsx)("b",{children:"Dettagli:"})})}),Object(z.jsx)("div",{className:"row",tabIndex:"0",children:Object(z.jsx)("div",{className:"col-12",children:this.state.reservation.description})}),Object(z.jsx)("div",{className:"row",tabIndex:"0",children:Object(z.jsx)("div",{className:"col-12",children:this.state.reservation.variableDiscount.onSale?"Sconto "+(this.state.reservation.variableDiscount.onSaleType?"del ":"di ")+parseFloat(this.state.reservation.variableDiscount.onSaleValue).toFixed(2)+(this.state.reservation.variableDiscount.onSaleType?"% ":" \u20ac ")+"sul costo giornaliero se superi "+this.state.reservation.variableDiscount.days+(parseInt(this.state.reservation.variableDiscount.days)>1?" giorni ":" giorno ")+"di noleggio.":""})})]}),Object(z.jsx)("hr",{}),"Prenotato"==this.state.status?Object(z.jsx)(H,{reservation:this.state.reservation,bookings:this.state.bookings}):"Attivo"==this.state.status?Object(z.jsx)(f.a,{className:"w-100",disabled:!0,children:"Prenotazione attiva"}):Object(z.jsx)(W,{reservation:this.state.reservation})]})]})})}}]),a}(i.a.Component),J=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={isAuthenticated:e.isAuthenticated},s}return Object(c.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({isAuthenticated:e.isAuthenticated})}},{key:"render",value:function(){var e=this;if(0==this.props.elements.length)return Object(z.jsx)("div",{style:{height:"75vh"},className:"d-flex justify-content-center align-items-center",children:"Non ci sono contenuti"});if("product"==this.props.type){var t=this.props.elements.map((function(t){return Object(z.jsx)(_,{product:t,isAuthenticated:e.state.isAuthenticated},t._id)}));return Object(z.jsx)("div",{id:"body",children:t})}if("reservation"==this.props.type){var a=this.props.elements.map((function(e){return Object(z.jsx)(q,{reservation:e},e._id)}));return Object(z.jsx)("div",{id:"body",children:a})}}}]),a}(i.a.Component),K=a(281),Q=a(274),X=a(279),Z=a(164),$=a(285),ee=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={isAuthenticated:e.isAuthenticated},s.logout=s.logout.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"logout",value:function(){b.a.remove("jwt"),window.location.href="/user/index.html"}},{key:"componentWillReceiveProps",value:function(e){this.setState({isAuthenticated:e.isAuthenticated})}},{key:"render",value:function(){var e=this;return 1==this.state.isAuthenticated?Object(z.jsxs)($.a,{className:"text-center d-flex align-items-center",navbarScroll:!0,children:["product"==this.props.type||"reservation"==this.props.type?Object(z.jsx)($.a.Link,{children:Object(z.jsx)(X.a,{className:"element-to-hide-over-350",onSubmit:function(t){t.preventDefault(),e.props.search(t.target.searchInput.value)},children:Object(z.jsx)(Z.a,{type:"search",placeholder:"product"==this.props.type?"Cerca un prodotto":"Cerca una prenotazione",name:"searchInput",className:"me-2","aria-label":"Cerca"})})}):Object(z.jsx)(z.Fragment,{}),Object(z.jsx)($.a.Link,{href:"./index.html",children:"Home"}),"user"==this.props.type?Object(z.jsx)(z.Fragment,{}):Object(z.jsx)($.a.Link,{href:"./page",children:"Pagina utente"}),"reservation"==this.props.type?Object(z.jsx)(z.Fragment,{}):Object(z.jsx)($.a.Link,{href:"./reservation",children:"Prenotazioni"}),Object(z.jsx)($.a.Link,{onClick:this.logout,children:"Logout"})]}):Object(z.jsxs)($.a,{className:"me-auto my-2 my-lg-0 text-center  align-items-center",navbarScroll:!0,children:[Object(z.jsx)($.a.Link,{className:"w-100",children:"user"==this.props.type?null:Object(z.jsx)(X.a,{className:"element-to-hide-over-350",onSubmit:function(t){t.preventDefault(),e.props.search(t.target.searchInput.value)},children:Object(z.jsx)(Z.a,{type:"search",placeholder:"product"==this.props.type?"Cerca un prodotto":"Cerca una prenotazione",name:"searchInput",className:"me-2","aria-label":"Cerca"})})}),Object(z.jsx)($.a.Link,{href:"/public/login.html",children:"login"})]})}}]),a}(i.a.Component),te=a(280),ae=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),s=t.call(this,e),"product"==e.type?s.state={filter1:["Disponibilit\xe0","Tutti","Disponibili","Non dispobili"],choise1:1,filter2:["Ordina per","Prezzo crescente","Prezzo descrescente"],choise2:1}:"reservation"==e.type&&(s.state={filter1:["Disponibilit\xe0","Tutte","Prenotate","Attive","Concluse"],choise1:1,filter2:["Ordina per","Data crescente","Data decrescente"],choise2:1}),s}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return"user"==this.props.type?Object(z.jsx)(z.Fragment,{}):Object(z.jsxs)("div",{className:"row p-2",children:[Object(z.jsx)("div",{className:"col-6 d-flex flex-row align-items-center",style:{overflowX:"visible !important"},children:Object(z.jsxs)(te.a,{children:[Object(z.jsx)(te.a.Toggle,{children:this.state.filter1[0]}),Object(z.jsxs)(te.a.Menu,{renderOnMount:!0,children:[Object(z.jsx)(te.a.Item,{active:1==this.state.choise1,onClick:function(){e.setState({choise1:1}),e.props.show(1)},children:this.state.filter1[1]}),Object(z.jsx)(te.a.Item,{active:2==this.state.choise1,onClick:function(){e.setState({choise1:2}),e.props.show(2)},children:this.state.filter1[2]}),Object(z.jsx)(te.a.Item,{active:3==this.state.choise1,onClick:function(){e.setState({choise1:3}),e.props.show(3)},children:this.state.filter1[3]}),"reservation"==this.props.type?Object(z.jsx)(te.a.Item,{active:4==this.state.choise1,onClick:function(){e.setState({choise1:4}),e.props.show(4)},children:this.state.filter1[4]}):Object(z.jsx)(z.Fragment,{})]})]})}),Object(z.jsx)("div",{className:"col-6 d-flex flex-row-reverse align-items-center",children:Object(z.jsxs)(te.a,{children:[Object(z.jsx)(te.a.Toggle,{children:this.state.filter2[0]}),Object(z.jsxs)(te.a.Menu,{children:[Object(z.jsx)(te.a.Item,{active:1==this.state.choise2,onClick:function(t){e.setState({choise2:1}),e.props.sort(!0)},children:this.state.filter2[1]}),Object(z.jsx)(te.a.Item,{active:2==this.state.choise2,onClick:function(){e.setState({choise2:2}),e.props.sort(!1)},children:this.state.filter2[2]})]})]})})]})}}]),a}(i.a.Component),se=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={isAuthenticated:e.isAuthenticated},s}return Object(c.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({isAuthenticated:e.isAuthenticated})}},{key:"render",value:function(){var e=this;return Object(z.jsxs)("div",{children:[Object(z.jsx)(K.a,{className:"bg-light w-100",expand:"false",children:Object(z.jsxs)(Q.a,{fluid:!0,children:[Object(z.jsx)(K.a.Brand,{href:"/user/index.html",className:"p-0 m-0",children:Object(z.jsx)("img",{src:"https://cdn.discordapp.com/attachments/888778821262790686/926860373775249469/nolonoloplus.png",alt:"logo NoloNoloPlus",height:"45px"})}),"user"==this.props.type?Object(z.jsx)("h1",{children:"Pagina utente"}):Object(z.jsx)(X.a,{className:"element-to-hide-under-350",style:{width:"60%"},onSubmit:function(t){t.preventDefault(),e.props.search(t.target.searchInput.value)},children:Object(z.jsx)(Z.a,{type:"search",placeholder:"product"==this.props.type?"Cerca un prodotto":"Cerca una prenotazione",name:"searchInput",className:"me-2","aria-label":"product"==this.props.type?"Cerca un prodotto":"Cerca una prenotazione"})}),Object(z.jsx)(K.a.Toggle,{style:{height:"45px",width:"45px",padding:"0px"},"aria-controls":"navbarScroll"}),Object(z.jsx)(K.a.Collapse,{id:"navbarScroll",children:Object(z.jsx)(ee,{isAuthenticated:this.state.isAuthenticated,type:this.props.type})})]})}),"product"==this.props.type||"reservation"==this.props.type?Object(z.jsx)(ae,{show:this.props.show,sort:this.props.sort,type:this.props.type}):Object(z.jsx)(z.Fragment,{})]})}}]),a}(i.a.Component),ie=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={products:[],filteredProducts:[],isAuthenticated:!1},s.searchProducts=s.searchProducts.bind(Object(l.a)(s)),s.showProducts=s.showProducts.bind(Object(l.a)(s)),s.sortProducts=s.sortProducts.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"searchProducts",value:function(e){var t=this;console.log("searchProducts("+e+")"),O.getAllProduct(e,!0).then((function(e){t.setState({products:e.data.data,filteredProducts:e.data.data})}))}},{key:"showProducts",value:function(e){console.log("showProducts("+e+")");var t=[];if(e>1){var a=2==e;for(var s in this.state.products)this.state.products[s].available==a&&t.push(this.state.products[s])}else t=this.state.products;this.setState({filteredProducts:t})}},{key:"sortProducts",value:function(e){console.log("sortProducts("+e+")");var t=this.state.products;t.sort((function(e,t){return e.price-t.price})),0==e&&t.reverse(),this.setState({products:t,filteredProducts:t})}},{key:"componentDidMount",value:function(){var e=this;this.searchProducts(""),b.a.get("jwt")&&O.getUser().then((function(){e.setState({isAuthenticated:!0})})).catch((function(){e.setState({isAuthenticated:!1})}))}},{key:"render",value:function(){return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(se,{type:"product",search:this.searchProducts,show:this.showProducts,sort:this.sortProducts,isAuthenticated:this.state.isAuthenticated}),Object(z.jsx)(J,{type:"product",elements:this.state.filteredProducts,isAuthenticated:this.state.isAuthenticated})]})}}]),a}(i.a.Component),re=a(4),ne=(a(222),a(165)),oe=a(275),ce=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={yearList:[{key:1,year:"2022"},{key:2,year:"2023"},{key:3,year:"2024"},{key:4,year:"2025"},{key:5,year:"2026"}],monthList:[{key:1,month:"Gennaio"},{key:2,month:"Febbraio"},{key:3,month:"Marzo"},{key:4,month:"Aprile"},{key:5,month:"Maggio"},{key:6,month:"Giugno"},{key:7,month:"Luglio"},{key:8,month:"Agosto"},{key:9,month:"Settembre"},{key:10,month:"Ottobre"},{key:11,month:"Novembre"},{key:12,month:"Dicembre "}],userId:"",userName:"",userSurname:"",userBirthday:{day:"",month:"",year:""},userPhoneNumber:"",userEmail:"",userAddress:{street:"",number:"",city:""},userPayment:{cardOwner:"",cardType:"",cardCode:"",cardExpireYear:"",cardExpireMonth:"",cardCVV:""},userSex:"",newSex:"",newCardType:"",newExprYear:"",newExprMonth:"",newBirthday:{year:"",month:"",day:""},boolModifying:!1,isAuth:!1,show:!1,loading:!0,done:!1},s.switchModifying=s.switchModifying.bind(Object(l.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(l.a)(s)),s.handleChange=s.handleChange.bind(Object(l.a)(s)),s.handleClose=s.handleClose.bind(Object(l.a)(s)),s.handleShow=s.handleShow.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"switchModifying",value:function(){var e=!this.state.boolModifying;this.setState({boolModifying:e})}},{key:"handleClose",value:function(){this.setState({show:!1}),window.location.reload(!1)}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=e.target.querySelectorAll("input");if(this.state.boolModifying){this.handleShow();var s={},i={addressCity:"",addressStreet:"",addressNumber:""},r={cardOwner:"",cardCode:0,cardExpireYear:this.state.newExprYear,cardExpireMonth:this.state.newExprMonth,cardType:this.state.newCardType,cardCVV:0};for(var n in a)"userAddressCity"==a[n].name?i.addressCity=a[n].value?a[n].value:a[n].placeholder:"userAddressStreet"==a[n].name?i.addressStreet=a[n].value?a[n].value:a[n].placeholder:"userAddressNumber"==a[n].name?i.addressNumber=a[n].value?a[n].value:a[n].placeholder:"userPaymentOwner"==a[n].name?r.cardOwner=a[n].value?a[n].value:a[n].placeholder:"userPaymentCardCode"==a[n].name?r.cardCode=a[n].value?parseInt(a[n].value):parseInt(a[n].placeholder):"userPaymentCVV"==a[n].name&&(r.cardCVV=a[n].value?parseInt(a[n].value):parseInt(a[n].placeholder));for(var n in a)a[n].value&&a[n].placeholder&&(""!=a[n].value&&a[n].value!=a[n].placeholder&&("userAddressCity"==a[n].name||"userAddressStreet"==a[n].name||"userAddressNumber"==a[n].name?s.address=i:"userPaymentCardCode"==a[n].name||"userPaymentOwner"==a[n].name||"userPaymentCVV"==a[n].name?s.payment=r:"userPhoneNumber"==a[n].name?s.phoneNumber=parseInt(a[n].value):"userPassword"==a[n].name?s.password=a[n].value:s[a[n].name]=a[n].value),"userPassword"==a[n].name&&"Password"==a[n].value&&(s.password=a[n].value));this.state.userSex!=this.state.newSex&&(s.sex=this.state.newSex),this.state.newCardType==this.state.userPayment.cardType&&this.state.newExprMonth==this.state.userPayment.cardExpireMonth&&this.state.newExprYear==this.state.userPayment.cardExpireYear||(s.payment=r),this.state.newBirthday.day==this.state.userBirthday.day&&this.state.newBirthday.month==this.state.userBirthday.month&&this.state.newBirthday.year==this.state.userBirthday.year||(s.birthday=this.state.newBirthday),O.postUser(null,s).then((function(){t.setState({loading:!1,done:!0})})).catch((function(){t.setState({loading:!1,done:!1})}))}this.switchModifying()}},{key:"componentDidMount",value:function(){var e=this;O.getUser().then((function(t){e.setState({userId:t.data.data._id,userName:t.data.data.userName,userSurname:t.data.data.userSurname,userBirthday:{day:t.data.data.birthday.day,month:t.data.data.birthday.month,year:t.data.data.birthday.year},userPhoneNumber:t.data.data.phoneNumber,userEmail:t.data.data.email,userAddress:{street:t.data.data.address.addressStreet,number:t.data.data.address.addressNumber,city:t.data.data.address.addressCity},userPayment:{cardOwner:t.data.data.payment.cardOwner,cardCode:t.data.data.payment.cardCode,cardType:t.data.data.payment.cardType,cardExpireYear:t.data.data.payment.cardExpireYear,cardExpireMonth:t.data.data.payment.cardExpireMonth,cardCVV:t.data.data.payment.cardCVV},userSex:t.data.data.sex,newSex:t.data.data.sex,newCardType:t.data.data.payment.cardType,newExprYear:t.data.data.payment.cardExpireYear,newExprMonth:t.data.data.payment.cardExpireMonth,newBirthday:{year:t.data.data.birthday.year,month:t.data.data.birthday.month,day:t.data.data.birthday.day},isAuth:!0})})).catch((function(){window.location.replace("/public/login.html")}))}},{key:"render",value:function(){var e,t=this;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(se,{type:"user",isAuthenticated:this.state.isAuth}),Object(z.jsx)("div",{id:"cont",className:"mt-2 mb-2","aria-label":"Pagina Utente",children:Object(z.jsxs)("form",{className:"m-0 p-0",onSubmit:this.handleSubmit,children:[Object(z.jsxs)("fieldset",{className:"m-0 p-0",disabled:!this.state.boolModifying,children:[Object(z.jsx)("h2",{className:"mt-0 mb-2",children:"Dati personali"}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Nome:"}),Object(z.jsx)(X.a.Control,{type:"text",name:"userName",placeholder:this.state.userName,"aria-label":"Nome utente:"})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Cognome:"}),Object(z.jsx)(X.a.Control,{type:"text",name:"userSurname",placeholder:this.state.userSurname,"aria-label":"Cognome utente:"})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{tabindex:this.state.boolModifying?"0":"-1",children:"Email (non modificabile):"}),Object(z.jsx)(X.a.Control,{type:"email",name:"userEmail",readOnly:!0,disabled:!0,placeholder:this.state.userEmail,"aria-label":"Email:"})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Password:"}),Object(z.jsx)(X.a.Control,{type:"password",name:"userPassword",placeholder:"password","aria-label":"Password:"})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Genere:"}),Object(z.jsxs)(X.a.Select,{className:"mb-2",value:this.state.newSex,onChange:function(e){t.setState({newSex:e.target.value})},"aria-label":"Genere:",children:[Object(z.jsx)("option",{value:"male",children:"Uomo"}),Object(z.jsx)("option",{value:"female",children:"Donna"}),Object(z.jsx)("option",{value:"other",children:"Altro"})]})]}),Object(z.jsxs)(X.a.Group,{as:ne.a,className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Data di Nascita:"}),Object(z.jsx)(X.a.Control,{type:"date",value:this.state.newBirthday.year+"-"+(this.state.newBirthday.month<10?"0"+this.state.newBirthday.month:this.state.newBirthday.month)+"-"+(this.state.newBirthday.day<10?"0"+this.state.newBirthday.day:this.state.newBirthday.day),max:"2004-02-03",min:"1900-01-01",name:"userBirthday","aria-label":"Data di nascita:",onChange:function(e){var a=e.target.value.split("-");t.setState({newBirthday:{year:parseInt(a[0]),month:parseInt(a[1]),day:parseInt(a[2])}})}})]}),Object(z.jsxs)(X.a.Group,{as:ne.a,className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Paese/Citt\xe0 di residenza:"}),Object(z.jsx)(X.a.Control,{type:"text",name:"userAddressCity",placeholder:this.state.userAddress.city,"aria-label":"Citt\xe0:"})]}),Object(z.jsxs)(oe.a,{children:[Object(z.jsxs)(X.a.Group,{as:ne.a,xs:8,className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Via di Residenza:"}),Object(z.jsx)(X.a.Control,{type:"text",name:"userAddressStreet",placeholder:this.state.userAddress.street,"aria-label":"Via"})]}),Object(z.jsxs)(X.a.Group,{as:ne.a,xs:4,className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Numero:"}),Object(z.jsx)(X.a.Control,{type:"text",name:"userAddressNumber",placeholder:this.state.userAddress.number,"aria-label":"Numero civico: "})]})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Numero di Telefono:"}),Object(z.jsx)(X.a.Control,{className:"remove-spin-box",type:"tel",pattern:"[0-9]{10}",name:"userPhoneNumber",placeholder:this.state.userPhoneNumber,"aria-label":"Numero di cellulare:"})]}),Object(z.jsx)("h2",{className:"mt-4 mb-2",children:"Metodo di Pagamento"}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Intestatario:"}),Object(z.jsx)(X.a.Control,{type:"text",name:"userPaymentOwner",placeholder:this.state.userPayment.cardOwner,"aria-label":"Intestatario della carta:"})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Numero della Carta:"}),Object(z.jsx)(X.a.Control,{type:"tel",pattern:"[0-9]{16}",className:"remove-spin-box",name:"userPaymentCardCode",placeholder:this.state.userPayment.cardCode,"aria-label":"Numero della carta:"})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"Tipo di Carta:"}),Object(z.jsxs)(X.a.Select,(e={className:"mb-2",value:this.state.newCardType,"aria-label":"Tipologia di carta:",onChange:function(e){t.setState({newCardType:e.target.value})}},Object(re.a)(e,"aria-label","Form Select Card Type"),Object(re.a)(e,"children",[Object(z.jsx)("option",{value:"debit",children:"Carta di debito"}),Object(z.jsx)("option",{value:"credit",children:"Carta di credito"}),Object(z.jsx)("option",{value:"prepaid",children:"Carta prepagata"})]),e))]}),Object(z.jsxs)(oe.a,{children:[Object(z.jsx)(X.a.Label,{children:"Scadenza della Carta:"}),Object(z.jsx)(ne.a,{xs:8,children:Object(z.jsx)(X.a.Select,{className:"mb-2",value:this.state.newExprMonth,"aria-label":"Mese di scadenza della carta:",onChange:function(e){t.setState({newExprMonth:parseInt(e.target.value)})},children:this.state.monthList.map((function(e){return Object(z.jsx)("option",{value:e.key,children:e.month},e.key)}))})}),Object(z.jsx)(ne.a,{xs:4,children:Object(z.jsx)(X.a.Select,{className:"mb-2",value:this.state.newExprYear,"aria-label":"Anno di scadenza della carta:",onChange:function(e){t.setState({newExprYear:parseInt(e.target.value)})},children:this.state.yearList.map((function(e){return Object(z.jsx)("option",{value:parseInt(e.key+2021),children:e.year},e.key)}))})})]}),Object(z.jsxs)(X.a.Group,{className:"mb-2",children:[Object(z.jsx)(X.a.Label,{children:"CVV:"}),Object(z.jsx)(X.a.Control,{type:"tel",pattern:"[0-9]{3}",className:"remove-spin-box",name:"userPaymentCVV",placeholder:this.state.userPayment.cardCVV,"aria-label":"CVV della carta:"})]})]}),Object(z.jsx)(f.a,{className:"mt-2 mb-2 w-100",type:"submit",value:"submit",variant:this.state.boolModifying?"success":"primary",children:this.state.boolModifying?"Salva":"Modifica"})]})}),Object(z.jsxs)(P.a,{show:this.state.show,onHide:this.handleClose,backdrop:"static",keyboard:!1,centered:!0,children:[Object(z.jsx)(P.a.Body,{children:this.state.loading?Object(z.jsxs)("div",{className:"d-flex align-items-center",children:["Salvataggio\xa0",Object(z.jsx)(C.a,{variant:"primary",animation:"border",role:"status",children:Object(z.jsx)("span",{className:"visually-hidden",children:"Caricamento..."})})]}):this.state.done?Object(z.jsx)(z.Fragment,{children:"Modifiche effettuate."}):Object(z.jsx)(z.Fragment,{children:"Errore durante il salvataggio delle modifiche."})}),Object(z.jsx)(P.a.Footer,{children:Object(z.jsx)(f.a,{variant:"secondary",onClick:this.handleClose,disabled:this.state.loading,children:"Chiudi"})})]})]})}}]),a}(s.Component),le=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={reservations:[],filteredReservations:[],isAuthenticated:!1},s.searchReservations=s.searchReservations.bind(Object(l.a)(s)),s.showReservations=s.showReservations.bind(Object(l.a)(s)),s.sortReservations=s.sortReservations.bind(Object(l.a)(s)),s}return Object(c.a)(a,[{key:"searchReservations",value:function(e){var t=this;console.log("searchReservations("+e+")"),O.getAllReservation(e,!0).then((function(e){t.setState({reservations:e.data.obj,filteredReservations:e.data.obj})}))}},{key:"showReservations",value:function(e){console.log("showReservations("+e+")");var t=[];if(parseInt(e)>1)for(var a in this.state.reservations)switch(parseInt(e)){case 2:0==this.state.reservations[a].isTaken&&0==this.state.reservations[a].isReturned&&t.push(this.state.reservations[a]);break;case 3:1==this.state.reservations[a].isTaken&&0==this.state.reservations[a].isReturned&&t.push(this.state.reservations[a]);break;case 4:1==this.state.reservations[a].isTaken&&1==this.state.reservations[a].isReturned&&t.push(this.state.reservations[a]);break;default:return}else t=this.state.reservations;this.setState({filteredReservations:t})}},{key:"sortReservations",value:function(e){console.log("sortReservations("+e+")");var t=this.state.reservations;t.sort((function(e,t){return new Date(e.bookingDate.year,e.bookingDate.month-1,e.bookingDate.day)-new Date(t.bookingDate.year,t.bookingDate.month-1,t.bookingDate.day)})),0==e&&t.reverse(),this.setState({reservations:t,filteredReservation:t})}},{key:"componentDidMount",value:function(){var e=this;this.searchReservations(""),b.a.get("jwt")&&O.getUser().then((function(){e.setState({isAuthenticated:!0})})).catch((function(){e.setState({isAuthenticated:!1}),window.location.replace("/public/login.html")}))}},{key:"render",value:function(){return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(se,{type:"reservation",search:this.searchReservations,show:this.showReservations,sort:this.sortReservations,isAuthenticated:this.state.isAuthenticated}),Object(z.jsx)(J,{type:"reservation",elements:this.state.filteredReservations,isAuthenticated:this.state.isAuthenticated})]})}}]),a}(i.a.Component),de=a(21);var he=function(){return Object(z.jsx)("div",{className:"App",children:Object(z.jsxs)(de.c,{children:[Object(z.jsx)(de.a,{path:"/user/index.html",element:Object(z.jsx)(ie,{})}),Object(z.jsx)(de.a,{path:"/user/page",element:Object(z.jsx)(ce,{})}),Object(z.jsx)(de.a,{path:"/user/reservation",element:Object(z.jsx)(le,{})})]})})},ue=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,292)).then((function(t){var a=t.getCLS,s=t.getFID,i=t.getFCP,r=t.getLCP,n=t.getTTFB;a(e),s(e),i(e),r(e),n(e)}))},be=a(134);n.a.render(Object(z.jsx)(be.a,{children:Object(z.jsx)(he,{})}),document.getElementById("root")),ue()}},[[223,1,2]]]);
//# sourceMappingURL=main.f465836f.chunk.js.map