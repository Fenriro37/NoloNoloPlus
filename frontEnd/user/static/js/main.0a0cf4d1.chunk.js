(this.webpackJsonpuser=this.webpackJsonpuser||[]).push([[0],{134:function(t,e){t.exports={site202131Url:"http://localhost:8081"}},165:function(t,e,a){},166:function(t,e,a){},196:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a.n(n),i=a(46),c=a.n(i),r=(a(165),a(166),a(167),a(20)),o=a(21),l=a(39),u=a(23),d=a(22),h=a(97),j=a.n(h),b=a(133),p=a.n(b),v=a(134),O=a.n(v),f=p.a.create({baseURL:O.a.site202131Url,headers:{"Content-type":"application/json",dataType:"jsonp",withCredentials:!0}}),x=new(function(){function t(){Object(r.a)(this,t)}return Object(o.a)(t,[{key:"test",value:function(){return f.get("/test")}},{key:"login",value:function(t,e){var a={email:t,plainTextPassword:e};return f.post("/api/public/login",a)}},{key:"signUp",value:function(){}},{key:"getUser",value:function(t){var e=t?"?id="+t:"";return f.get("/api/user/"+e)}},{key:"postUser",value:function(t,e){return null!=t?f.post("/api/user?id="+t,e):f.post("/api/user",e)}},{key:"getProduct",value:function(t){return f.get("/api/product/?id="+t)}},{key:"getAllProduct",value:function(t,e){return f.get("/api/product/all?filter="+t+"&&sort="+e)}},{key:"postProduct",value:function(t,e){return f.post("/api/product/?id="+t,e)}},{key:"getReservation",value:function(t){return f.get("/api/reservation/?id="+t)}},{key:"getAllReservation",value:function(t,e){return f.get("/api/reservation/all",{filter:t,sort:e})}},{key:"postReservation",value:function(t){return f.post("/api/reservation",t)}}]),t}()),m=a(254),g=a(139),y=a(3),k=a(248),P=a(260),A=a(236),D=a(249),w=a(251),N=a(1);function S(t){return{day:t.getDate().toString(),month:(t.getMonth()+1).toString(),year:t.getFullYear().toString()}}function C(t,e){return Math.round((e-t)/864e5)+1}function I(t,e){return!!t.find((function(t){return new Date(t).getTime()==e.getTime()}))}Date.prototype.addDays=function(t){var e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e};var R=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;Object(r.a)(this,a),n=e.call(this,t);var s=function(t){var e=0,a=[];for(e in t)for(var n=new Date(parseInt(t[e].startDate.year),parseInt(t[e].startDate.month)-1,parseInt(t[e].startDate.day)),s=new Date(parseInt(t[e].endDate.year),parseInt(t[e].endDate.month)-1,parseInt(t[e].endDate.day)),i=n;i<=s;)a.push(new Date(i)),i=i.addDays(1);return a}(t.bookings).map((function(t){return t.getTime()}));return n.state={value:[null,null],dates:s,bookings:t.bookings,price:t.finalPrice,product:t.product,isAuthenticated:t.isAuthenticated},n.disabledDays=n.disabledDays.bind(Object(l.a)(n)),n.checkDateRange=n.checkDateRange.bind(Object(l.a)(n)),n.bookReservation=n.bookReservation.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"disabledDays",value:function(t){return null==this.state.dates?null:this.state.dates.includes(t.getTime())}},{key:"checkDateRange",value:function(t){if(2==t.length&&null!=this.state.dates&&t[0]&&t[1]){for(var e=t[0],a=t[1];e<=a;){if(1==I(this.state.dates,e))return!1;e=e.addDays(1)}return!0}return!1}},{key:"bookReservation",value:function(){var t=this;if(!this.state.value[0]||!this.state.value[1])return alert("Data prenotazione non valida");x.getUser().then((function(e){var a={clientEmail:e.data.data.email,clientName:e.data.data.userName,clientSurname:e.data.data.userSurname,productId:t.state.product._id,prodcutTitle:t.state.product.title,productBrand:t.state.product.brand,productImage:t.state.product.image,bookingDate:S(new Date),startDate:S(t.state.value[0]),endDate:S(t.state.value[1]),isTaken:!1,isReturned:!1,price:(C(t.state.value[0],t.state.value[1])*t.state.price).toFixed(2),description:"",note:""};x.postReservation(a).then((function(a){var n={productId:t.state.product._id,clientId:e.data.data.email,reservationId:a.data.data._id,startDate:S(t.state.value[0]),endDate:S(t.state.value[1])},s=t.state.bookings;s.push(n),x.postProduct(t.state.product._id,{bookings:s}).then((function(){alert("Prenotazione effettuata con successo"),window.location.reload(!1)}))}))}))}},{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{className:"pb-0 mt-2",children:[Object(N.jsx)(P.a,{className:"d-flex justify-content-center mb-2",children:Object(N.jsx)(A.b,{dateAdapter:k.a,children:Object(N.jsx)(D.a,{disablePast:!0,shouldDisableDate:this.disabledDays,startText:"Data di inizio",endText:"Data di fine",value:this.state.value,onChange:function(e){t.setState({value:e})},renderInput:function(t,e){return Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)(w.a,Object(y.a)({},t)),Object(N.jsx)(P.a,{sx:{mx:1},children:"a"}),Object(N.jsx)(w.a,Object(y.a)({},e))]})},inputFormat:"dd/MM/yyyy"})})}),Object(N.jsxs)("div",{children:["Giorni di noleggio: ",this.state.value[0]&&this.state.value[1]?C(this.state.value[0],this.state.value[1]):0]}),Object(N.jsxs)("div",{children:["Prezzo totale: ",this.state.value[0]&&this.state.value[1]?(C(this.state.value[0],this.state.value[1])*this.state.price).toFixed(2):"0.00"," \u20ac"]}),this.state.isAuthenticated?Object(N.jsx)(g.a,{disabled:!this.checkDateRange(this.state.value),className:"mt-3 w-100",onClick:function(e){e.preventDefault(),t.bookReservation()},children:this.checkDateRange(this.state.value)?Object(N.jsx)("span",{children:"Prenota ora"}):Object(N.jsx)("span",{children:"Seleziona una data valida"})}):Object(N.jsx)(g.a,{className:"mt-2 w-100",href:"/public/login.html",children:"Accedi per prenotare"})]})}}]),a}(s.a.Component),z=a(257),T=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=parseInt(this.props.quality);return Object(N.jsxs)("div",{className:"d-flex align-items-center",children:[Object(N.jsx)("b",{children:"Qualit\xe0:"}),Object(N.jsx)(z.a,{name:"read-only",value:t,max:3,readOnly:!0})]})}}]),a}(s.a.Component),F=a(246),L=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=this.props.tags.map((function(t){return Object(N.jsx)(F.a,{pill:!0,bg:"primary",className:"m-1",children:t},t)}));return Object(N.jsxs)("div",{children:[Object(N.jsx)("b",{children:"Categoria:"}),Object(N.jsx)("div",{className:"d-flex justify-content-center flex-wrap",children:t})]})}}]),a}(s.a.Component),U=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={originalPrice:parseFloat(n.props.originalPrice),discountedPrice:parseFloat(n.props.discountedPrice)},n}return Object(o.a)(a,[{key:"render",value:function(){return this.state.originalPrice!=this.state.discountedPrice?Object(N.jsxs)("div",{children:[Object(N.jsxs)("span",{style:{textDecorationLine:"line-through"},children:[Object(N.jsx)("b",{children:"Prezzo: "})," ",this.state.originalPrice," \u20ac ",Object(N.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]}),Object(N.jsx)("br",{}),Object(N.jsxs)("span",{style:{color:"red"},children:[Object(N.jsx)("b",{children:"Prezzo scontato: "})," ",this.state.discountedPrice," \u20ac ",Object(N.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]})]}):Object(N.jsxs)("div",{children:[Object(N.jsx)("b",{children:"Prezzo: "})," ",this.state.originalPrice," \u20ac ",Object(N.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]})}}]),a}(s.a.Component),M=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={product:t.product,isAuthenticated:t.isAuthenticated,discountedPrice:t.product.discount.onSaleType?(t.product.price*(100-t.product.discount.onSaleValue)/100).toFixed(2):(t.product.price-t.product.discount.onSaleValue).toFixed(2)},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){return Object(N.jsx)(m.a,{className:"m-2 bg-light rounded-3 border border-dark",children:Object(N.jsxs)(m.a.Item,{eventKey:"0",children:[Object(N.jsx)(m.a.Header,{children:Object(N.jsxs)("div",{className:"row",style:{width:"95%",height:"12.5vh"},children:[Object(N.jsx)("div",{className:"col-6 h-100 d-flex align-items-center",children:Object(N.jsx)("img",{className:"img-fluid img-responsive mx-auto d-block",style:{maxHeight:"100%",maxWidth:"100%"},src:this.state.product.image,alt:"Immagine"})}),Object(N.jsx)("div",{className:"col-6 d-flex align-items-center",children:Object(N.jsxs)("div",{children:[Object(N.jsx)("b",{children:this.state.product.title}),Object(N.jsx)("br",{}),this.state.product.brand]})})]})}),Object(N.jsxs)(m.a.Body,{children:[Object(N.jsx)(L,{tags:this.state.product.tags}),Object(N.jsxs)("div",{style:{textAlign:"justify"},children:[Object(N.jsx)("b",{children:"Descrizione:"}),Object(N.jsx)("br",{}),this.state.product.description]}),Object(N.jsx)(T,{quality:this.state.product.quality}),Object(N.jsx)(U,{discountedPrice:this.state.discountedPrice,originalPrice:this.state.product.price}),Object(N.jsx)("hr",{}),Object(N.jsx)("div",{className:"mb-2",children:Object(N.jsx)("b",{children:"Prenotazione:"})}),this.state.product.available?Object(N.jsx)(R,{bookings:this.state.product.bookings,finalPrice:this.state.product.discount.onSale?this.state.discountedPrice:this.state.product.price,isAuthenticated:this.state.isAuthenticated,product:this.state.product}):Object(N.jsx)(g.a,{disabled:!0,className:"w-100",children:"Prodotto non disponibile"})]})]})})}}]),a}(s.a.Component),W=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;if(0==this.props.products.length)return Object(N.jsx)("div",{});var e=this.props.products.map((function(e){return Object(N.jsx)(M,{product:e,isAuthenticated:t.state.isAuthenticated},e._id)}));return Object(N.jsx)("div",{id:"body",children:e})}}]),a}(s.a.Component),B=a(252),_=a(247),q=a(253),E=a(141),H=a(255),J=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)("h1",{children:"Page"}),Object(N.jsx)(Y,{})]})}}]),a}(s.a.Component),V=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){return Object(N.jsx)("h1",{children:"Reservation"})}}]),a}(s.a.Component),G=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n.logout=n.logout.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"logout",value:function(){j.a.remove("jwt"),window.location.href="/user/index.html"}},{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return 1==this.state.isAuthenticated?Object(N.jsxs)(H.a,{className:"text-center d-flex align-items-center",navbarScroll:!0,children:[Object(N.jsx)(H.a.Link,{children:Object(N.jsx)(q.a,{className:"element-to-hide-over-350",onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(N.jsx)(E.a,{type:"search",placeholder:"Cerca",name:"searchInput",className:"me-2","aria-label":"Cerca"})})}),Object(N.jsx)(H.a.Link,{href:"./page",children:"Personal page"}),Object(N.jsx)(H.a.Link,{href:"./reservation",children:"Reservation"}),Object(N.jsx)(H.a.Link,{onClick:this.logout,children:"Logout"})]}):Object(N.jsxs)(H.a,{className:"me-auto my-2 my-lg-0 text-center  align-items-center",navbarScroll:!0,children:[Object(N.jsx)(H.a.Link,{className:"w-100",children:Object(N.jsx)(q.a,{className:"element-to-hide-over-350",onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(N.jsx)(E.a,{type:"search",placeholder:"Cerca",name:"searchInput",className:"me-2","aria-label":"Cerca"})})}),Object(N.jsx)(H.a.Link,{href:"/public/login.html",children:"login"})]})}}]),a}(s.a.Component),K=a(250),Q=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{className:"row p-2",children:[Object(N.jsx)("div",{className:"col-6 d-flex flex-row align-items-center",children:Object(N.jsx)(q.a.Check,{type:"checkbox",label:"Disponibilit\xe0",title:"Dis",className:"m-0",onChange:function(e){t.props.showOnlyAvailable(e.target.checked)}})}),Object(N.jsx)("div",{className:"col-6 d-flex flex-row-reverse align-items-center",children:Object(N.jsxs)(K.a,{children:[Object(N.jsx)(K.a.Toggle,{id:"dropdown-basic",children:"Ordina"}),Object(N.jsxs)(K.a.Menu,{children:[Object(N.jsx)(K.a.Item,{onClick:function(e){t.props.sort(!0)},children:"Prezzo crescente"}),Object(N.jsx)(K.a.Item,{onClick:function(e){t.props.sort(!1)},children:"Prezzo decrescente"})]})]})})]})}}]),a}(s.a.Component),Y=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{children:[Object(N.jsx)(B.a,{className:"bg-light w-100",expand:"false",children:Object(N.jsxs)(_.a,{fluid:!0,children:[Object(N.jsx)(B.a.Brand,{href:"/user/index.html",className:"p-0 m-0",children:Object(N.jsx)("img",{src:"https://cdn.discordapp.com/attachments/888778821262790686/926860373775249469/nolonoloplus.png",alt:"logo NoloNoloPlus",height:"45px"})}),Object(N.jsx)(q.a,{className:"element-to-hide-under-350",style:{width:"60%"},onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(N.jsx)(E.a,{type:"search",placeholder:"Cerca... ",name:"searchInput",className:"me-2","aria-label":"Cerca prodotti"})}),Object(N.jsx)(B.a.Toggle,{style:{height:"45px",width:"45px",padding:"0px"},"aria-controls":"navbarScroll"}),Object(N.jsx)(B.a.Collapse,{id:"navbarScroll",children:Object(N.jsx)(G,{isAuthenticated:this.state.isAuthenticated})})]})}),Object(N.jsx)(Q,{showOnlyAvailable:this.props.showOnlyAvailable,sort:this.props.sort})]})}}]),a}(s.a.Component),X=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={products:[],filteredProducts:[],isAuthenticated:!1},n.searchProducts=n.searchProducts.bind(Object(l.a)(n)),n.showOnlyAvailableProducts=n.showOnlyAvailableProducts.bind(Object(l.a)(n)),n.sortProducts=n.sortProducts.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"searchProducts",value:function(t){var e=this;console.log("searchProducts("+t+")"),x.getAllProduct(t,!0).then((function(t){e.setState({products:t.data.data,filteredProducts:t.data.data})}))}},{key:"showOnlyAvailableProducts",value:function(t){console.log("showOnlyAvailableProducts("+t+")");var e=[];if(1==t)for(var a in this.state.products)this.state.products[a].available==t&&e.push(this.state.products[a]);else e=this.state.products;this.setState({filteredProducts:e})}},{key:"sortProducts",value:function(t){console.log("sortProducts("+t+")");var e=this.state.products;e.sort((function(t,e){return t.price-e.price})),0==t&&e.reverse(),this.setState({products:e,filteredProducts:e})}},{key:"componentDidMount",value:function(){var t=this;x.getAllProduct("",!0).then((function(e){t.setState({products:e.data.data,filteredProducts:e.data.data})})),j.a.get("jwt")&&x.getUser().then((function(){t.setState({isAuthenticated:!0})})).catch((function(){t.setState({isAuthenticated:!1})}))}},{key:"render",value:function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)(Y,{search:this.searchProducts,showOnlyAvailable:this.showOnlyAvailableProducts,sort:this.sortProducts,isAuthenticated:this.state.isAuthenticated}),Object(N.jsx)(W,{products:this.state.filteredProducts,isAuthenticated:this.state.isAuthenticated})]})}}]),a}(s.a.Component),Z=a(18);var $=function(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsxs)(Z.c,{children:[Object(N.jsx)(Z.a,{path:"/user/index.html",element:Object(N.jsx)(X,{})}),Object(N.jsx)(Z.a,{path:"/user/page",element:Object(N.jsx)(J,{})}),Object(N.jsx)(Z.a,{path:"/user/reservation",element:Object(N.jsx)(V,{})})]})})},tt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,262)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),n(t),s(t),i(t),c(t)}))},et=a(96);c.a.render(Object(N.jsx)(et.a,{children:Object(N.jsx)($,{})}),document.getElementById("root")),tt()}},[[196,1,2]]]);
//# sourceMappingURL=main.0a0cf4d1.chunk.js.map