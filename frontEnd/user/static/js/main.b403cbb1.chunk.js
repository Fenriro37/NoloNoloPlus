(this.webpackJsonpuser=this.webpackJsonpuser||[]).push([[0],{125:function(t,e){t.exports={site202131Url:"http://localhost:8081"}},156:function(t,e,a){},157:function(t,e,a){},187:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a.n(n),i=a(43),c=a.n(i),r=(a(156),a(157),a(19)),o=a(20),l=a(37),u=a(24),d=a(23),h=a(90),j=a.n(h),p=a(124),b=a.n(p),v=a(125),f=a.n(v),O=b.a.create({baseURL:f.a.site202131Url,headers:{"Content-type":"application/json",dataType:"jsonp",withCredentials:!0}}),m=new(function(){function t(){Object(r.a)(this,t)}return Object(o.a)(t,[{key:"test",value:function(){return O.get("/test")}},{key:"login",value:function(t,e){var a={email:t,plainTextPassword:e};return O.post("/api/public/login",a)}},{key:"signUp",value:function(){}},{key:"getUser",value:function(t){var e=t?"?id="+t:"";return O.get("/api/user/"+e)}},{key:"postUser",value:function(t,e){return null!=t?O.post("/api/user?id="+t,e):O.post("/api/user",e)}},{key:"getProduct",value:function(t){return O.get("/api/product/?id="+t)}},{key:"getAllProduct",value:function(t,e){return O.get("/api/product/all?filter="+t+"&&sort="+e)}},{key:"postProduct",value:function(t,e){return O.post("/api/product/?id="+t,e)}},{key:"getReservation",value:function(t){return O.get("/api/reservation/?id="+t)}},{key:"getAllReservation",value:function(t,e){return O.get("/api/reservation/all",{filter:t,sort:e})}},{key:"postReservation",value:function(t){return O.post("/api/reservation",t)}}]),t}()),x=a(244),g=a(246),y=a(130),k=a(4),A=a(240),P=a(253),D=a(229),w=a(241),S=a(243),N=a(1);function C(t){return{day:t.getDate().toString(),month:(t.getMonth()+1).toString(),year:t.getFullYear().toString()}}function I(t,e){return Math.round((e-t)/864e5)+1}function R(t,e){return!!t.find((function(t){return new Date(t).getTime()==e.getTime()}))}Date.prototype.addDays=function(t){var e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e};var T=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;Object(r.a)(this,a),n=e.call(this,t);var s=function(t){var e=0,a=[];for(e in t)for(var n=new Date(parseInt(t[e].startDate.year),parseInt(t[e].startDate.month)-1,parseInt(t[e].startDate.day)),s=new Date(parseInt(t[e].endDate.year),parseInt(t[e].endDate.month)-1,parseInt(t[e].endDate.day)),i=n;i<=s;)a.push(new Date(i)),i=i.addDays(1);return a}(t.bookings).map((function(t){return t.getTime()}));return n.state={value:[null,null],dates:s,bookings:t.bookings,price:t.finalPrice,product:t.product,isAuthenticated:t.isAuthenticated},n.disabledDays=n.disabledDays.bind(Object(l.a)(n)),n.checkDateRange=n.checkDateRange.bind(Object(l.a)(n)),n.bookReservation=n.bookReservation.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"disabledDays",value:function(t){return null==this.state.dates?null:this.state.dates.includes(t.getTime())}},{key:"checkDateRange",value:function(t){if(2==t.length&&null!=this.state.dates&&t[0]&&t[1]){for(var e=t[0],a=t[1];e<=a;){if(1==R(this.state.dates,e))return!1;e=e.addDays(1)}return!0}return!1}},{key:"bookReservation",value:function(){var t=this;if(!this.state.value[0]||!this.state.value[1])return alert("Data prenotazione non valida");m.getUser().then((function(e){var a={clientEmail:e.data.data.email,clientName:e.data.data.userName,clientSurname:e.data.data.userSurname,productId:t.state.product._id,prodcutTitle:t.state.product.title,productBrand:t.state.product.brand,productImage:t.state.product.image,bookingDate:C(new Date),startDate:C(t.state.value[0]),endDate:C(t.state.value[1]),isTaken:!1,isReturned:!1,price:(I(t.state.value[0],t.state.value[1])*t.state.price).toFixed(2),description:"",note:""};m.postReservation(a).then((function(a){var n={productId:t.state.product._id,clientId:e.data.data.email,reservationId:a.data.data._id,startDate:C(t.state.value[0]),endDate:C(t.state.value[1])},s=t.state.bookings;s.push(n),m.postProduct(t.state.product._id,{bookings:s}).then((function(){alert("Prenotazione effettuata con successo"),window.location.reload(!1)}))}))}))}},{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{className:"pb-0 mt-2",children:[Object(N.jsx)(P.a,{className:"d-flex justify-content-center mb-2",children:Object(N.jsx)(D.b,{dateAdapter:A.a,children:Object(N.jsx)(w.a,{disablePast:!0,shouldDisableDate:this.disabledDays,startText:"Data di inizio",endText:"Data di fine",value:this.state.value,onChange:function(e){t.setState({value:e})},renderInput:function(t,e){return Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)(S.a,Object(k.a)({},t)),Object(N.jsx)(P.a,{sx:{mx:1},children:"a"}),Object(N.jsx)(S.a,Object(k.a)({},e))]})},inputFormat:"dd/MM/yyyy"})})}),Object(N.jsxs)("div",{children:["Giorni di noleggio: ",this.state.value[0]&&this.state.value[1]?I(this.state.value[0],this.state.value[1]):0]}),Object(N.jsxs)("div",{children:["Prezzo totale: ",this.state.value[0]&&this.state.value[1]?(I(this.state.value[0],this.state.value[1])*this.state.price).toFixed(2):0," \u20ac"]}),this.state.isAuthenticated?Object(N.jsx)(y.a,{disabled:!this.checkDateRange(this.state.value),className:"mt-3 w-100",onClick:function(e){e.preventDefault(),t.bookReservation()},children:this.checkDateRange(this.state.value)?Object(N.jsx)("span",{children:"Prenota ora"}):Object(N.jsx)("span",{children:"Seleziona una data valida"})}):Object(N.jsx)(y.a,{className:"mt-2 w-100",href:"/public/login.html",children:"Accedi per prenotare"})]})}}]),a}(s.a.Component),z=a(249),F=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=parseInt(this.props.quality);return Object(N.jsxs)("div",{className:"mb-1 d-flex align-items-center",children:["Qualit\xe0:",Object(N.jsx)(z.a,{name:"read-only",value:t,max:3,readOnly:!0})]})}}]),a}(s.a.Component),L=a(251),U=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=this.props.tags.map((function(t){return Object(N.jsx)(L.a,{className:"m-1",label:t},t)}));return Object(N.jsx)("div",{className:"mb-1 d-flex justify-content-center flex-wrap",children:t})}}]),a}(s.a.Component),M=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={product:t.product,isAuthenticated:t.isAuthenticated,discountedPrice:t.product.discount.onSaleType?(t.product.price*(100-t.product.discount.onSaleValue)/100).toFixed(2):(t.product.price-t.product.discount.onSaleValue).toFixed(2)},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){return Object(N.jsx)("div",{className:"m-2 bg-light rounded-3 border border-dark",children:Object(N.jsxs)(x.a,{bg:"trasparent",expand:"false",children:[Object(N.jsx)(x.a.Toggle,{"aria-controls":"navbarScroll",className:"border-0 w-100",style:{height:"15vh"},children:Object(N.jsxs)("div",{className:"row m-0 h-100",children:[Object(N.jsx)("div",{className:"col-5 p-0 d-flex align-items-center align-self-center h-100",children:Object(N.jsx)("img",{className:"img-fluid img-responsive mx-auto d-block",style:{maxHeight:"100%",maxWidth:"35vw"},src:this.state.product.image,alt:"Immagine"})}),Object(N.jsxs)("div",{className:"col-7 bg-trasparent align-self-center",style:{paddingRight:"0"},children:[Object(N.jsx)("div",{className:"text-truncate",children:this.state.product.title}),Object(N.jsx)("div",{children:this.state.product.brand}),this.state.product.discount.onSale?Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{style:{color:"red"},children:[this.state.discountedPrice," \u20ac ",Object(N.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]}),Object(N.jsxs)("div",{style:{textDecorationLine:"line-through",fontSize:"0.75em"},children:[this.state.product.price," \u20ac"]})]}):Object(N.jsxs)("div",{children:[this.state.product.price," \u20ac ",Object(N.jsx)("span",{style:{fontSize:"0.75em"},children:"al giorno"})]})]})]})}),Object(N.jsx)(x.a.Collapse,{id:"navbarScroll",children:Object(N.jsxs)(g.a,{className:"me-auto p-2 pb-0",navbarScroll:!0,children:[Object(N.jsx)(U,{tags:this.state.product.tags}),Object(N.jsx)("div",{style:{textAlign:"justify"},children:this.state.product.description}),Object(N.jsx)(F,{quality:this.state.product.quality}),this.state.product.available?Object(N.jsx)(T,{bookings:this.state.product.bookings,finalPrice:this.state.product.discount.onSale?this.state.discountedPrice:this.state.product.price,isAuthenticated:this.state.isAuthenticated,product:this.state.product}):Object(N.jsx)(y.a,{disabled:!0,children:"Prodotto non disponibile"})]})})]})})}}]),a}(s.a.Component),W=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;if(0==this.props.products.length)return Object(N.jsx)("div",{});var e=this.props.products.map((function(e){return Object(N.jsx)(M,{product:e,isAuthenticated:t.state.isAuthenticated},e._id)}));return Object(N.jsx)("div",{children:e})}}]),a}(s.a.Component),_=a(239),B=a(245),q=a(132),E=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n.logout=n.logout.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"logout",value:function(){j.a.remove("jwt"),window.location.href="/user/index.html"}},{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return 1==this.state.isAuthenticated?Object(N.jsxs)(g.a,{className:"text-center d-flex align-items-center",navbarScroll:!0,children:[Object(N.jsx)(g.a.Link,{children:Object(N.jsx)(B.a,{className:"element-to-hide-over-350",onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(N.jsx)(q.a,{type:"search",placeholder:"Cerca",name:"searchInput",className:"me-2","aria-label":"Cerca"})})}),Object(N.jsx)(g.a.Link,{href:"#action1",children:"Pagina personale"}),Object(N.jsx)(g.a.Link,{href:"#action2",children:"Prenotazioni effettuate"}),Object(N.jsx)(g.a.Link,{onClick:this.logout,children:"Logout"})]}):Object(N.jsxs)(g.a,{className:"me-auto my-2 my-lg-0 text-center  align-items-center",navbarScroll:!0,children:[Object(N.jsx)(g.a.Link,{className:"w-100",children:Object(N.jsx)(B.a,{className:"element-to-hide-over-350",onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(N.jsx)(q.a,{type:"search",placeholder:"Cerca",name:"searchInput",className:"me-2","aria-label":"Cerca"})})}),Object(N.jsx)(g.a.Link,{href:"/public/login.html",children:"login"})]})}}]),a}(s.a.Component),J=a(242),V=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){return Object(r.a)(this,a),e.call(this,t)}return Object(o.a)(a,[{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{className:"row p-2",children:[Object(N.jsx)("div",{className:"col-6 d-flex flex-row align-items-center",children:Object(N.jsx)(B.a.Check,{type:"checkbox",label:"Disponibilit\xe0",className:"m-0",onChange:function(e){t.props.showOnlyAvailable(e.target.checked)}})}),Object(N.jsx)("div",{className:"col-6 d-flex flex-row-reverse align-items-center",children:Object(N.jsxs)(J.a,{children:[Object(N.jsx)(J.a.Toggle,{id:"dropdown-basic",children:"Ordina"}),Object(N.jsxs)(J.a.Menu,{children:[Object(N.jsx)(J.a.Item,{onClick:function(e){t.props.sort(!0)},children:"Prezzo crescente"}),Object(N.jsx)(J.a.Item,{onClick:function(e){t.props.sort(!1)},children:"Prezzo decrescente"})]})]})})]})}}]),a}(s.a.Component),G=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={isAuthenticated:t.isAuthenticated},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({isAuthenticated:t.isAuthenticated})}},{key:"render",value:function(){var t=this;return Object(N.jsxs)("div",{children:[Object(N.jsx)(x.a,{className:"bg-light w-100",expand:"false",children:Object(N.jsxs)(_.a,{fluid:!0,children:[Object(N.jsx)(x.a.Brand,{href:"/user/index.html",className:"p-0 m-0",children:Object(N.jsx)("img",{src:"https://cdn.discordapp.com/attachments/918079016651604009/918082983964061726/CAtena_montuosa.png",alt:"logo NoloNoloPlus",height:"37.5em"})}),Object(N.jsx)(B.a,{className:"element-to-hide-under-350",style:{width:"60%"},onSubmit:function(e){e.preventDefault(),t.props.search(e.target.searchInput.value)},children:Object(N.jsx)(q.a,{type:"search",placeholder:"Cerca",name:"searchInput",className:"me-2","aria-label":"Cerca"})}),Object(N.jsx)(x.a.Toggle,{"aria-controls":"navbarScroll"}),Object(N.jsx)(x.a.Collapse,{id:"navbarScroll",children:Object(N.jsx)(E,{isAuthenticated:this.state.isAuthenticated})})]})}),Object(N.jsx)(V,{showOnlyAvailable:this.props.showOnlyAvailable,sort:this.props.sort})]})}}]),a}(s.a.Component),H=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).state={products:[],filteredProducts:[],isAuthenticated:!1},n.searchProducts=n.searchProducts.bind(Object(l.a)(n)),n.showOnlyAvailableProducts=n.showOnlyAvailableProducts.bind(Object(l.a)(n)),n.sortProducts=n.sortProducts.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"searchProducts",value:function(t){var e=this;console.log("searchProducts("+t+")"),m.getAllProduct(t,!0).then((function(t){e.setState({products:t.data.data,filteredProducts:t.data.data})}))}},{key:"showOnlyAvailableProducts",value:function(t){console.log("showOnlyAvailableProducts("+t+")");var e=[];if(1==t)for(var a in this.state.products)this.state.products[a].available==t&&e.push(this.state.products[a]);else e=this.state.products;this.setState({filteredProducts:e})}},{key:"sortProducts",value:function(t){console.log("sortProducts("+t+")");var e=this.state.products;e.sort((function(t,e){return t.price-e.price})),0==t&&e.reverse(),this.setState({products:e,filteredProducts:e})}},{key:"componentDidMount",value:function(){var t=this;m.getAllProduct("",!0).then((function(e){t.setState({products:e.data.data,filteredProducts:e.data.data})})),j.a.get("jwt")&&m.getUser().then((function(){t.setState({isAuthenticated:!0})})).catch((function(){t.setState({isAuthenticated:!1})}))}},{key:"render",value:function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)(G,{search:this.searchProducts,showOnlyAvailable:this.showOnlyAvailableProducts,sort:this.sortProducts,isAuthenticated:this.state.isAuthenticated}),Object(N.jsx)(W,{products:this.state.filteredProducts,isAuthenticated:this.state.isAuthenticated})]})}}]),a}(s.a.Component);a(186);var Q=function(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsx)(H,{})})},Y=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,256)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),n(t),s(t),i(t),c(t)}))};c.a.render(Object(N.jsx)(s.a.StrictMode,{children:Object(N.jsx)(Q,{})}),document.getElementById("root")),Y()}},[[187,1,2]]]);
//# sourceMappingURL=main.b403cbb1.chunk.js.map